<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Calcolatore BMI Moderno</title>

  <style>
    /* ----- CSS Reset e Stili Globali ----- */
    :root {
      --primary-color: #007bff;
      --normal-color: #009688;
      --underweight-color: #ffc107;
      --overweight-color: #ff9800;
      --obese-color: #f44336;
      --background-color: #f4f7f9;
      --card-background: #ffffff;
      --text-color: #333;
      --label-color: #555;
      --border-color: #ddd;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background-color: var(--background-color);
      color: var(--text-color);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 1rem;
    }

    /* ----- Contenitore Principale (La "Scheda") ----- */
    .container {
      width: 100%;
      max-width: 400px;
      background-color: var(--card-background);
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
      text-align: center;
    }

    h1 {
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }

    .author {
      font-size: 0.9rem;
      color: #888;
      margin-bottom: 2rem;
    }

    /* ----- Sezione Input ----- */
    .input-group {
      margin-bottom: 1.5rem;
      text-align: left;
    }

    label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 600;
      color: var(--label-color);
    }

    .input-wrapper {
      display: flex;
      align-items: center;
    }

    input[type="number"] {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 1.2rem;
      text-align: center;
      -moz-appearance: textfield; /* Rimuove frecce in Firefox */
    }
    input[type="number"]::-webkit-inner-spin-button,
    input[type="number"]::-webkit-outer-spin-button {
        -webkit-appearance: none; /* Rimuove frecce in Chrome/Safari */
        margin: 0;
    }


    .adjust-buttons button {
      width: 45px;
      height: 45px;
      margin-left: 0.5rem;
      border: 1px solid var(--border-color);
      background-color: #fff;
      color: var(--primary-color);
      font-size: 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: background-color 0.2s, color 0.2s;
    }
    .adjust-buttons button:hover {
      background-color: var(--primary-color);
      color: #fff;
    }

    /* ----- Sezione Risultati ----- */
    .result-section {
      margin-top: 2rem;
    }

    #result {
      font-size: 3.5rem;
      font-weight: 700;
      line-height: 1;
      margin-bottom: 0.5rem;
      color: var(--normal-color);
      transition: color 0.3s;
    }

    #status {
      font-size: 1.2rem;
      font-weight: 500;
      height: 1.5rem; /* Altezza fissa per evitare "salti" del layout */
    }
    
    /* ----- Barra del BMI ----- */
    .bar-container {
      margin-top: 2rem;
    }

    .bar {
      position: relative;
      height: 12px;
      background: linear-gradient(to right, var(--underweight-color), var(--normal-color) 45%, var(--overweight-color) 70%, var(--obese-color));
      border-radius: 6px;
    }

    .pointer {
      position: absolute;
      top: -6px; /* Posiziona il puntatore a metà della barra */
      transform: translateX(-50%);
      width: 0;
      height: 0;
      border-left: 12px solid transparent;
      border-right: 12px solid transparent;
      border-top: 20px solid var(--primary-color);
      transition: left 0.3s ease-out;
    }

    .bar-labels {
      display: flex;
      justify-content: space-between;
      font-size: 0.75rem;
      color: #777;
      margin-top: 0.75rem;
      padding: 0 5px;
    }
  </style>
</head>
<body>

  <main class="container">
    <h1>Calcolatore BMI</h1>
    <p class="author">By Teresa Mazzarisi</p>

    <div class="input-group">
      <label for="height">Altezza (cm)</label>
      <div class="input-wrapper">
        <input type="number" id="height" value="170">
        <div class="adjust-buttons">
          <button data-target="height" data-step="1">▲</button>
          <button data-target="height" data-step="-1">▼</button>
        </div>
      </div>
    </div>

    <div class="input-group">
      <label for="weight">Peso (kg)</label>
      <div class="input-wrapper">
        <input type="number" id="weight" value="70" step="0.5">
        <div class="adjust-buttons">
          <button data-target="weight" data-step="0.5">▲</button>
          <button data-target="weight" data-step="-0.5">▼</button>
        </div>
      </div>
    </div>

    <div class="result-section">
      <div id="result">--</div>
      <div id="status"></div>
    </div>
    
    <div class="bar-container">
        <div class="bar">
            <div id="pointer" class="pointer"></div>
        </div>
        <div class="bar-labels">
            <span>Sottopeso</span>
            <span>Normale</span>
            <span>Sovrappeso</span>
            <span>Obeso</span>
        </div>
    </div>
  </main>

  <script>
    // Attendere che il documento sia completamente caricato
    document.addEventListener('DOMContentLoaded', () => {

      // ----- Selezione degli Elementi del DOM -----
      const heightInput = document.getElementById('height');
      const weightInput = document.getElementById('weight');
      const resultEl = document.getElementById('result');
      const statusEl = document.getElementById('status');
      const pointerEl = document.getElementById('pointer');
      const adjustButtons = document.querySelectorAll('.adjust-buttons button');

      // ----- Funzione Principale per il Calcolo -----
      function calculateBMI() {
        const height = parseFloat(heightInput.value) / 100; // Converti cm in metri
        const weight = parseFloat(weightInput.value);

        // Se i valori non sono validi, esci
        if (!height || !weight || height <= 0 || weight <= 0) {
            resultEl.textContent = '--';
            statusEl.textContent = 'Inserisci valori validi';
            return;
        }

        const bmi = weight / (height * height);
        resultEl.textContent = bmi.toFixed(1);

        // Determina la categoria e il colore associato
        let category = '';
        let color = '';
        if (bmi < 18.5) {
          category = 'Sottopeso';
          color = 'var(--underweight-color)';
        } else if (bmi < 25) {
          category = 'Normopeso';
          color = 'var(--normal-color)';
        } else if (bmi < 30) {
          category = 'Sovrappeso';
          color = 'var(--overweight-color)';
        } else {
          category = 'Obeso';
          color = 'var(--obese-color)';
        }
        statusEl.textContent = category;
        resultEl.style.color = color;
        statusEl.style.color = color;

        // Aggiorna la posizione del puntatore sulla barra
        // Mappiamo il valore del BMI (es: da 15 a 40) su una percentuale (0% a 100%)
        const minBmi = 15;
        const maxBmi = 40;
        const percentage = Math.min(Math.max((bmi - minBmi) / (maxBmi - minBmi), 0), 1) * 100;
        pointerEl.style.left = `${percentage}%`;
      }

      // ----- Gestione degli Eventi -----

      // Calcola quando i valori di input cambiano
      heightInput.addEventListener('input', calculateBMI);
      weightInput.addEventListener('input', calculateBMI);

      // Gestisce il click sui pulsanti ▲ e ▼
      adjustButtons.forEach(button => {
        button.addEventListener('click', () => {
          const targetId = button.dataset.target;
          const step = parseFloat(button.dataset.step);
          const targetInput = document.getElementById(targetId);
          
          let currentValue = parseFloat(targetInput.value);
          if (isNaN(currentValue)) currentValue = 0;

          // Arrotonda per evitare problemi con i decimali del peso
          let newValue = (currentValue + step).toFixed(1);
          if (targetId === 'height') {
              newValue = Math.round(currentValue + step);
          }
          
          targetInput.value = newValue;
          
          // Richiama il calcolo dopo aver modificato il valore
          calculateBMI();
        });
      });

      // Esegui un primo calcolo al caricamento della pagina
      calculateBMI();
    });
  </script>

</body>
</html>