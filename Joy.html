<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Joy Fit</title>
    
    <meta name="theme-color" content="#3498db">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Joy Fit">
    
    <link rel="icon" href="https://sebastiano-mazzarisi.github.io/Test/JoyFit.jpg">
    <link rel="apple-touch-icon" href="https://sebastiano-mazzarisi.github.io/Test/JoyFit.jpg">

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
            scroll-behavior: smooth;
            font-size: 1.1em;
        }
        .container {
            max-width: 900px;
            margin: 20px auto;
            background-color: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            display: flex;
            flex-direction: column;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-top: 10px;
            margin-bottom: 20px;
            font-size: 2.8em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        .logo {
            height: 64px;
            width: 64px;
            border-radius: 8px;
            object-fit: cover;
            vertical-align: middle;
        }
        h2 {
            color: #3498db;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
            margin-top: 35px;
            font-size: 2em;
        }
        h3 {
            color: #2ecc71;
            margin-top: 25px;
            font-size: 1.6em;
        }
        p {
            margin-bottom: 15px;
            color: #555;
            font-size: 1.1em;
        }
        ul {
            list-style: none;
            padding: 0;
        }
        ul li {
            background-color: #ecf0f1;
            margin-bottom: 8px;
            padding: 12px 15px;
            border-radius: 8px;
            border-left: 5px solid #95a5a6;
            font-size: 1.05em;
        }
        .button-section {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .button {
            background-color: #3498db;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15);
            flex: 1 1 250px;
            max-width: 300px;
            text-align: center;
            text-decoration: none;
            box-sizing: border-box;
        }
        .button:hover {
            background-color: #2980b9;
            transform: translateY(-3px);
        }
        .emoji {
            font-size: 1.5em;
            margin-right: 8px;
            vertical-align: middle;
            line-height: 0;
        }
        .calculation-box {
            background-color: #e8f6f3;
            border: 1px solid #d1eeeb;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 1.1em;
            color: #21618C;
        }
        .calculation-box strong {
            color: #1a5276;
        }
        .calculator-section {
            background-color: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 25px;
            border-radius: 12px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .calculator-title {
            color: #2c3e50;
            font-size: 1.4em;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        .calculator-grid {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
        }
        .calculator-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .calculator-row {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        .calculator-label {
            font-weight: bold;
            color: #495057;
            flex-shrink: 0;
        }
        .calculator-select {
            padding: 10px 15px;
            border: 2px solid #ced4da;
            border-radius: 8px;
            font-size: 1.1em;
            background-color: #fefcbf;
            cursor: pointer;
            transition: border-color 0.3s ease;
            width: 100%;
        }
        .calculator-select:focus {
            outline: none;
            border-color: #3498db;
        }
        .calculator-result {
            background-color: #e3f2fd;
            border: 2px solid #bbdefb;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            font-size: 1.1em;
        }
        .result-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            padding: 8px 0;
            border-bottom: 1px solid #90caf9;
        }
        .result-row:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        .result-label {
            font-weight: bold;
            color: #1565c0;
        }
        .result-value {
            font-weight: bold;
            color: #0d47a1;
            font-size: 1.2em;
        }
        #dynamic-content-area {
            border-top: 1px solid #e0e0e0;
            padding-top: 20px;
            margin-top: 20px;
            min-height: 100px;
        }
        .content-section {
            display: none;
        }
        .back-to-top-button {
            display: block;
            margin-top: 30px;
            padding: 15px 30px;
            background-color: #6c757d;
            color: white;
            text-align: center;
            border-radius: 8px;
            text-decoration: none;
            transition: background-color 0.3s ease;
            font-size: 1.2em;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
            cursor: pointer;
        }
        .back-to-top-button:hover {
            background-color: #5a6268;
        }

        @media (max-width: 768px) {
            body { font-size: 1em; padding: 10px; }
            .container { padding: 20px; margin: 10px auto; }
            .logo { height: 56px; width: 56px; }
            .button { flex: 1 1 calc(50% - 15px); font-size: 1.1em; padding: 12px 25px; }
            h1 { font-size: 2.2em; margin-top: 5px; margin-bottom: 5px; }
            p { font-size: 1em; }
            ul li { font-size: 1em; }
            .calculator-section { padding: 15px; margin-top: 15px; margin-bottom: 15px; }
            .calculator-title { font-size: 1.3em; margin-bottom: 15px; }
            .calculator-grid { flex-direction: column; gap: 5px; }
            .calculator-column { gap: 20px; }
            .calculator-row { flex-direction: column; align-items: stretch; gap: 8px; margin-bottom: 0; }
            .calculator-label { min-width: auto; font-size: 1.1em; margin-bottom: 5px; }
            .calculator-select { width: 100%; padding: 12px 15px; font-size: 1.2em; box-sizing: border-box; }
            .calculator-result { padding: 15px; margin-top: 15px; }
            .result-row { flex-direction: column; align-items: stretch; padding: 12px 0; gap: 5px; }
            .result-label { font-size: 1em; margin-bottom: 3px; }
            .result-value { font-size: 1.4em; text-align: right; color: #0d47a1; }
            .calculation-box { padding: 15px; margin-top: 15px; font-size: 1em; }
            .calculation-box h3 { font-size: 1.2em; margin-bottom: 12px; }
            .calculation-box div[style*="background-color: #fff"] { padding: 12px !important; font-size: 1em !important; }
            .calculation-box div[style*="font-size: 0.95em"] { font-size: 0.9em !important; }
        }

        @media (max-width: 480px) {
            body { font-size: 0.95em; padding: 5px; }
            .container { padding: 15px; margin: 5px auto; }
            .logo { height: 50px; width: 50px; }
            .button { flex: 1 1 100%; font-size: 1.1em; padding: 10px 20px; margin-bottom: 10px; }
            h1 { font-size: 1.8em; margin-top: 5px; margin-bottom: 5px; }
            h2 { font-size: 1.5em; margin-top: 25px; }
            p { font-size: 1em; }
            ul li { font-size: 1em; padding: 10px 12px; }
            .calculator-section { padding: 12px; }
            .calculator-title { font-size: 1.2em; }
            .calculator-select { padding: 14px 12px; font-size: 1.1em; }
            .result-value { font-size: 1.3em; }
            .calculation-box { padding: 12px; }
            .calculation-box h3 { font-size: 1.1em; }
        }
    </style>
</head>
<body id="top">
    <div class="container">
        <h1>
            <img class="logo" src="https://sebastiano-mazzarisi.github.io/Test/JoyFit.jpg" alt="Joy Fit Logo"> 
            <span>Joy Fit</span>
        </h1> 
        <div class="button-section" id="button-section">
            <button class="button" onclick="showContent('fitto')"><span class="emoji">üè†</span>Revisione Fitto</button>
            <button class="button" onclick="showContent('versamento')"><span class="emoji">üí∞</span>Restituzione Versamento</button>
            <button class="button" onclick="showContent('amministratore')"><span class="emoji">üëî</span>Retribuzione Amministratore</button>
            <button class="button" onclick="showContent('checco')"><span class="emoji">üèãÔ∏è‚Äç‚ôÇÔ∏è</span>Retribuzione Checco</button>
            <button class="button" onclick="showContent('mimmo')"><span class="emoji">üßë‚Äç‚öïÔ∏è</span>Retribuzione Mimmo</button>
            <button class="button" onclick="showContent('marica')"><span class="emoji">üë©</span>Retribuzione Marica</button>
            <button class="button" onclick="showContent('vantaggio')"><span class="emoji">üìà</span>Futuro</button>
            <button class="button" onclick="printSummary()"><span class="emoji">üñ®Ô∏è</span>Stampa Riepilogo</button>
        </div>

        <div id="dynamic-content-area"></div>

        <div style="display: none;">
            <div id="fitto" class="content-section">
<h2>Revisione fitto</h2>
<p>Il valore dell‚Äôimmobile √® aumentato con il <strong>nuovo soppalco</strong>: valutare l‚Äôaumento del fitto a <strong>‚Ç¨ 3.600/mese</strong> con <strong>rivalutazione ISTAT</strong>, tutto dichiarato ufficialmente.</p>
</div>

            <div id="versamento" class="content-section">
<h2>Restituzione versamento iniziale</h2>
<p>Nel <strong>2005</strong> la palestra aveva debiti di circa <strong>‚Ç¨ 70.000</strong>. Ho investito <strong>‚Ç¨ 120.000</strong> (atto 23/12/2005) acquistando il 25% della societ√†, con accordo di rientro tramite assunzione e pagamento dei soli contributi (circa <strong>‚Ç¨ 50.000/anno</strong>).  Nel <strong>2006</strong> mi sono laureato in Informatica e ho riscattato <strong>18 mesi</strong> versando <strong>‚Ç¨ 61.250</strong> per accedere alla pensione retributiva.</p>
<p><p>Dal <strong>2006</strong> √® stata assunta Marica, percependo per <strong>10 anni</strong> solo i contributi (<strong>‚Ç¨ 250‚Äì300/mese</strong>). Oggi il suo <strong>netto</strong> √® ancora <strong>inferiore a ‚Ç¨ 1.000/mese</strong>.  √à il momento di pianificare la <strong>restituzione dei ‚Ç¨ 120.000</strong> con <strong>rate mensili</strong>.</p>
<div class="calculator-section">
                    <div class="calculator-title">Calcolatore Restituzione</div>
                    <div class="calculator-grid">
                        <div class="calculator-column">
                            <div class="calculator-row">
                                <span class="calculator-label">Interesse prestito:</span>
                                <select id="interessePrestito" class="calculator-select" onchange="calculateLoan()">
                                    <option value="2.0">2,0% (ISTAT)</option>
                                    <option value="2.5">2,5%</option>
                                    <option value="3.0" selected>3,0% (BOT-CCT)</option>
                                    <option value="3.5">3,5%</option>
                                    <option value="4.0">4,0%</option>
                                    <option value="4.5">4,5%</option>
                                    <option value="5.0">5,0% (A rischio)</option>
                                </select>
                            </div>
                        </div>
                        <div class="calculator-column">
                            <div class="calculator-row">
                                <span class="calculator-label">Interesse restituzione:</span>
                                <select id="interesseRestituzione" class="calculator-select" onchange="calculateLoan()">
                                    <option value="2.0">2,0%</option>
                                    <option value="2.5">2,5%</option>
                                    <option value="3.0" selected>3,0%</option>
                                    <option value="3.5">3,5%</option>
                                    <option value="4.0">4,0%</option>
                                    <option value="4.5">4,5%</option>
                                </select>
                            </div>
                            <div class="calculator-row">
                                <span class="calculator-label">Restituzione in anni:</span>
                                <select id="anni" class="calculator-select" onchange="calculateLoan()">
                                    <option value="1">1 anno</option>
                                    <option value="2">2 anni</option>
                                    <option value="5">5 anni</option>
                                    <option value="10">10 anni</option>
                                    <option value="15">15 anni</option>
                                    <option value="20" selected>20 anni</option>
                                    <option value="25">25 anni</option>
                                    <option value="30">30 anni</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="calculator-result" id="risultati">
                        <div class="result-row">
                            <span class="result-label">Capitale al 23/12/2005:</span>
                            <span class="result-value">‚Ç¨ 120.000</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">Montante oggi (<span id="data-oggi"></span>):</span>
                            <span class="result-value" id="montante">‚Ç¨ 0</span>
                        </div>
                        <div class="result-row">
                            <span class="result-label">Rata mensile:</span>
                            <span class="result-value" id="rata">‚Ç¨ 0</span>
                        </div>
                    </div>
                </div>

                <div class="calculation-box">
                    <h3 style="color: #1a5276; margin-top: 0; margin-bottom: 15px; text-align: center;">Formule finanziarie utilizzate</h3>
                    <div style="margin-bottom: 20px;">
                        <strong style="color: #1a5276;">Calcolo del Montante (Interesse Composto):</strong>
                        <div style="background-color: #fff; padding: 15px; border-radius: 6px; margin-top: 8px; font-family: monospace; font-size: 1.1em; border-left: 4px solid #3498db; overflow-x: auto;">
                            M = C &times; (1 + i)<sup>n</sup>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.95em; color: #2c3e50;">
                            <strong>M</strong>: Montante finale, <strong>C</strong>: Capitale iniziale (‚Ç¨ 120.000), <strong>i</strong>: Tasso annuo (prestito), <strong>n</strong>: Anni trascorsi.
                        </div>
                    </div>
                    <div>
                        <strong style="color: #1a5276;">Calcolo della Rata Mensile (Ammortamento francese):</strong>
                        <div style="background-color: #fff; padding: 15px; border-radius: 6px; margin-top: 8px; font-family: monospace; font-size: 1.1em; border-left: 4px solid #e74c3c; overflow-x: auto;">
                            R = M &times; [i<sub>m</sub> &times; (1 + i<sub>m</sub>)<sup>t</sup>] / [(1 + i<sub>m</sub>)<sup>t</sup> - 1]
                        </div>
                         <div style="margin-top: 10px; font-size: 0.95em; color: #2c3e50;">
                            <strong>R</strong>: Rata mensile, <strong>M</strong>: Montante da restituire, <strong>i<sub>m</sub></strong>: Tasso mensile (restituzione &divide; 12), <strong>t</strong>: Mesi totali.
                        </div>
                    </div>
                </div>
            </div>

            <div id="amministratore" class="content-section">
<h2>Retribuzione amministratore</h2>
<p>Ruolo da compensare con <strong>importo annuo</strong> e <strong>polizza assicurativa</strong>, anche se svolto da esterni. L‚Äôamministratore non pu√≤ coprire al 100% altri ruoli.</p>
</div>

            <div id="checco" class="content-section">
<h2>Retribuzione Checco</h2>
<p><strong>Sospendere extra e incentivi</strong>. Compenso basato sul <strong>mercato locale</strong> per un istruttore/gestore con lo stesso carico di lavoro residuo, oltre al ruolo di amministratore.</p>
</div>

            <div id="mimmo" class="content-section">
<h2>Retribuzione Mimmo</h2>
<p><strong>Eliminare</strong> l‚Äôincentivo a ‚Äúpaziente‚Äù. Retribuzione determinata dal <strong>valore di mercato</strong> per il ruolo.</p>
</div>

            <div id="marica" class="content-section">
<h2>Retribuzione Marica</h2>
<p><strong>Stipendio ufficiale, equo e dignitoso</strong>. Niente ricalcoli mensili o restituzioni di tredicesime/TFR. No incentivi a cottimo.</p>
</div>

            <div id="vantaggio" class="content-section">
<h2>Futuro</h2>
<ul>
    <li><strong>Amministratore</strong> a rotazione o esterno di fiducia.</li>
    <li>Pagamento ai soci <strong>lavoratori</strong> secondo <strong>mercato</strong>; i soci non lavoratori non percepiscono retribuzioni.</li>
    <li><strong>Divisione extra</strong> semestrale tra i soci: <strong>Checco, Marica e Flavia</strong>.</li>
</ul>
</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const TITLES = {
                'fitto': 'üè† Revisione Fitto',
                'versamento': 'üí∞ Restituzione Versamento Iniziale',
                'amministratore': 'üëî Retribuzione Amministratore',
                'checco': 'üèãÔ∏è‚Äç‚ôÇÔ∏è Retribuzione Checco',
                'mimmo': 'üßë‚Äç‚öïÔ∏è Retribuzione Mimmo',
                'marica': 'üë© Retribuzione Marica',
                'vantaggio': 'üìà Futuro'
            };

            window.showContent = function(sectionId) {
                const dynamicContentArea = document.getElementById('dynamic-content-area');
                const sourceSection = document.getElementById(sectionId);
                const buttonSection = document.getElementById('button-section'); 

                dynamicContentArea.innerHTML = '';

                if (sourceSection) {
                    const clonedContent = sourceSection.cloneNode(true);
                    const h2 = clonedContent.querySelector('h2');
                    if (h2 && TITLES[sectionId]) {
                        h2.innerHTML = TITLES[sectionId];
                    }
                    clonedContent.style.display = 'block';
                    dynamicContentArea.appendChild(clonedContent);
                    
                    if (sectionId === 'versamento') {
                        setTimeout(() => calculateLoan(), 50);
                    }
                    
                    buttonSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            };

            window.calculateLoan = function() {
                const capitale = 120000;
                const dataInizio = new Date(2005, 11, 23); // Mese 11 = Dicembre
                const dataOggi = new Date();
                
                const gg = String(dataOggi.getDate()).padStart(2, '0');
                const mm = String(dataOggi.getMonth() + 1).padStart(2, '0');
                const aaaa = dataOggi.getFullYear();
                const dataOggiEl = document.getElementById('data-oggi');
                if(dataOggiEl) {
                    dataOggiEl.textContent = `${gg}/${mm}/${aaaa}`;
                }

                const interessePrestitoEl = document.getElementById('interessePrestito');
                const interesseRestituzioneEl = document.getElementById('interesseRestituzione');
                const anniEl = document.getElementById('anni');

                if (!interessePrestitoEl || !interesseRestituzioneEl || !anniEl) return;

                const interessePrestito = parseFloat(interessePrestitoEl.value) / 100;
                const interesseRestituzione = parseFloat(interesseRestituzioneEl.value) / 100;
                const anniRestituzione = parseInt(anniEl.value);

                const anniTrascorsi = (dataOggi - dataInizio) / (1000 * 60 * 60 * 24 * 365.25);
                
                const montante = capitale * Math.pow(1 + interessePrestito, anniTrascorsi);
                const mesiRestituzione = anniRestituzione * 12;
                const interesseMensileRestituzione = interesseRestituzione / 12;
                
                let rataMensile;
                if (interesseMensileRestituzione === 0) {
                    rataMensile = montante / mesiRestituzione;
                } else {
                    rataMensile = montante * (interesseMensileRestituzione * Math.pow(1 + interesseMensileRestituzione, mesiRestituzione)) / 
                                 (Math.pow(1 + interesseMensileRestituzione, mesiRestituzione) - 1);
                }
                
                const montanteArrotondato = Math.round(montante / 100) * 100;
                const rataArrotondata = Math.round(rataMensile / 100) * 100;

                const montanteEl = document.getElementById('montante');
                const rataEl = document.getElementById('rata');
                if (montanteEl) montanteEl.textContent = '‚Ç¨ ' + formatNumber(montanteArrotondato);
                if (rataEl) rataEl.textContent = '‚Ç¨ ' + formatNumber(rataArrotondata);
            };

            window.formatNumber = function(num) {
                return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
            };

            window.resetApp = function() {
                const dynamicContentArea = document.getElementById('dynamic-content-area');
                dynamicContentArea.innerHTML = '';
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            function collectSectionsAsHTML() {
                const order = ['fitto', 'versamento', 'amministratore', 'checco', 'mimmo', 'marica', 'vantaggio'];
                const hiddenContainer = document.querySelector('div[style*="display: none"]');
                let html = '';
                
                order.forEach(id => {
                    const sectionNode = hiddenContainer.querySelector('#' + id);
                    if (!sectionNode) return;

                    const clone = sectionNode.cloneNode(true);
                    
                    clone.querySelectorAll('.calculator-section, .calculation-box, .back-to-top-button, h2').forEach(el => el.remove());
                    
                    const title = TITLES[id] || '';
                    html += `<h3>${title}</h3>`;
                    
                    clone.childNodes.forEach(node => {
                        if (node.nodeName === 'P' || node.nodeName === 'H3' || node.nodeName === 'UL') {
                           html += node.outerHTML;
                        }
                    });
                    html += '<hr>';
                });
                return html.slice(0, -4); // Rimuove l'ultimo <hr>
            }

            function buildPrintableHTML(logoSrc) {
                const dateStr = new Date().toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit', year: 'numeric' });
                const content = collectSectionsAsHTML();
                return `<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Joy Fit ‚Äî Riepilogo</title>
<style>
@page { size: A4; margin: 14mm; }
body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; color: #333; }
h1 { font-size: 18pt; margin: 0 0 8pt; display:flex; align-items:center; gap:10px; color: #2c3e50; }
h1 img { height: 24pt; width: 24pt; border-radius:4px; object-fit:cover; }
h3 { font-size: 13pt; margin: 16pt 0 6pt; color: #3498db; }
p, li { font-size: 10.5pt; margin: 4pt 0; line-height: 1.5; }
ul { margin: 4pt 0 6pt 20pt; padding: 0; list-style-type: disc; }
.small { font-size: 9pt; color: #555; margin-bottom: 8pt; }
hr { border: none; border-top: 1px solid #ccc; margin: 12pt 0; }
strong { color: #000; }
</style>
</head>
<body>
<h1><img src="${logoSrc}" alt="logo"> Joy Fit ‚Äî Riepilogo del ${dateStr}</h1>
<hr>
${content}
<script>
window.onload = function(){ 
    window.print(); 
    setTimeout(() => window.close(), 500); 
};
<\/script>
</body>
</html>`;
            }

            window.printSummary = function() {
                const logoEl = document.querySelector('.logo');
                const logoSrc = logoEl ? logoEl.src : '';
                const printableHTML = buildPrintableHTML(logoSrc);
                const printWindow = window.open('', '_blank');
                
                if (printWindow) {
                    printWindow.document.open();
                    printWindow.document.write(printableHTML);
                    printWindow.document.close();
                } else {
                    alert('La stampa √® stata bloccata dal browser. Disattiva il blocco popup per questo sito e riprova.');
                }
            };

        });
    </script>
</body>
</html>