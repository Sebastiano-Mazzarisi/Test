<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Immobile per Studi Medici - Opportunit√† di Investimento</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #ffffff 0%, #f0f8ff 100%);
            min-height: 100vh;
        }

        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }

        /* Header - AZZURRO CHIARO */
        .header {
            background: linear-gradient(135deg, #4a90e2 0%, #87ceeb 100%);
            color: white; text-align: center; padding: 2rem 0; margin-bottom: 2rem;
            position: relative; overflow: hidden;
        }

        .header-image {
            height: 300px;
            width: auto;
            max-width: 100%;
            object-fit: contain;
            border-radius: 12px;
            margin: 1rem auto;
            display: block;
            cursor: pointer;
        }

        .header h1 { font-size: clamp(1.8rem, 4vw, 2.5rem); margin-bottom: 0.5rem; font-weight: 300; }
        .header p { font-size: clamp(1rem, 2.5vw, 1.2rem); opacity: 0.9; }

        /* Navigation Tabs - BLU CHIARO */
        .nav-tabs {
            display: flex; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap; gap: 0.5rem;
        }

        .tab-btn {
            background: #ffffff; border: 2px solid #87ceeb; color: #1e88e5;
            padding: 0.8rem 1.5rem; border-radius: 25px; cursor: pointer;
            transition: all 0.3s ease; font-size: clamp(0.9rem, 2vw, 1rem);
            font-weight: 500; white-space: nowrap;
            box-shadow: 0 3px 10px rgba(135, 206, 235, 0.2);
        }
        .tab-btn:hover, .tab-btn.active {
            background: #1e88e5; color: white; border-color: #1e88e5; transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 136, 229, 0.4);
        }

        /* Content Sections */
        .content-section {
            display: none; background: white; border-radius: 20px; padding: 2rem; margin-bottom: 2rem;
            box-shadow: 0 8px 25px rgba(135, 206, 235, 0.15); animation: fadeIn 0.5s ease-in-out;
        }
        .content-section.active { display: block; }

        /* Gallery section tighter padding */
        #gallery.content-section { padding: 1rem; }

        @keyframes fadeIn { from{opacity:0; transform: translateY(20px);} to{opacity:1; transform: translateY(0);} }

        .section-title { color: #1e88e5; font-size: clamp(1.5rem, 3vw, 2rem); margin-bottom: 1.5rem; text-align: center; font-weight: 300; }

        /* Image Gallery */
        .image-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 8px; /* pi√π compatta */
            margin-bottom: 1rem;
        }

        .gallery-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
            background: transparent;   /* niente cornice bianca */
            box-shadow: none;          /* niente ombra ampia */
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .gallery-item:hover { transform: scale(1.03); }

        .gallery-item img {
            height: 150px;
            width: auto;
            object-fit: contain;
            display: block;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #d0d0d0; /* sottile cornice grigio chiara solo sulle miniature */
        }
        /* Variante opzionale per mostrare l'intera immagine senza tagli: basta aggiungere la classe 'contain' a .image-gallery */
        .image-gallery.contain .gallery-item img {
            height: 150px;
            width: auto;
            object-fit: contain;
            display: block;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #d0d0d0; /* sottile cornice grigio chiara solo sulle miniature */
        }

        .gallery-item .caption { display: none; }

        /* Feature Cards - AZZURRO VIVACE */
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem; margin-bottom: 2rem; }
        .feature-card {
            background: linear-gradient(135deg, #87ceeb 0%, #4a90e2 100%);
            color: white; padding: 1.5rem; border-radius: 20px; text-align: center; transition: transform 0.3s ease;
            box-shadow: 0 8px 25px rgba(135, 206, 235, 0.3); cursor: pointer;
        }
        .feature-card:hover { transform: translateY(-5px); box-shadow: 0 12px 35px rgba(135, 206, 235, 0.4); }
        .feature-icon { font-size: 2.5rem; margin-bottom: 1rem; }
        .feature-title { font-size: clamp(1.1rem, 2.5vw, 1.3rem); margin-bottom: 0.5rem; font-weight: 500; }
        .feature-text { font-size: clamp(0.9rem, 2vw, 1rem); opacity: 0.9; }

        /* Info Sections */
        .info-section { margin-bottom: 2rem; }
        .info-title { color: #1e88e5; font-size: clamp(1.2rem, 2.5vw, 1.4rem); margin-bottom: 1rem; font-weight: 500; }
        .info-content { font-size: clamp(1rem, 2vw, 1.1rem); line-height: 1.8; color: #555; }
        .highlight-box {
            background: linear-gradient(135deg, #e8f8e8 0%, #d0f0d0 100%);
            padding: 1.5rem; border-radius: 15px; margin: 1rem 0; color: #2e7d32;
            border: 1px solid #81c784; box-shadow: 0 3px 10px rgba(129, 199, 132, 0.2);
        }

        /* Contact Section - AZZURRO LUMINOSO */
        .contact-section {
            background: linear-gradient(135deg, #4a90e2 0%, #87ceeb 100%);
            color: white; padding: 2rem; border-radius: 20px; text-align: center; margin-top: 2rem;
            box-shadow: 0 8px 25px rgba(74, 144, 226, 0.3);
        }
        .contact-title { font-size: clamp(1.5rem, 3vw, 2rem); margin-bottom: 1rem; }
        .contact-info { font-size: clamp(1rem, 2.5vw, 1.2rem); margin-bottom: 1rem; }
        .contact-btn {
            background: white; color: #1e88e5; border: 2px solid #87ceeb; padding: 1rem 2rem; border-radius: 25px;
            font-size: clamp(1rem, 2vw, 1.1rem); font-weight: 500; cursor: pointer; transition: all 0.3s ease;
            margin: 0.5rem; box-shadow: 0 3px 10px rgba(255, 255, 255, 0.3);
        }
        .contact-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(255, 255, 255, 0.4); border-color: #4a90e2; }

        /* Modal per le immagini */
        .modal {
            display: none; position: fixed; z-index: 1000; inset: 0;
            background-color: rgba(0,0,0,0.9); justify-content: center; align-items: center;
        }
        .modal-content-container { position: relative; width: 90%; max-width: 960px; }
        .modal-content { display: block; width: 100%; height: auto; max-height: 80vh; object-fit: contain; border-radius: 15px; }
        .close { position: absolute; top: 15px; right: 35px; color: #f1f1f1; font-size: 40px; font-weight: bold; cursor: pointer; }
        .prev, .next {
            cursor: pointer; position: absolute; top: 50%; width: auto; padding: 16px; color: white; font-weight: bold; font-size: 2rem;
            transition: 0.3s ease; user-select: none; background-color: rgba(0,0,0,0.5); transform: translateY(-50%);
        }
        .prev { left: 0; border-radius: 0 8px 8px 0; }
        .next { right: 0; border-radius: 8px 0 0 8px; }
        .prev:hover, .next:hover { background-color: rgba(0,0,0,0.8); }

        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-tabs { flex-direction: column; align-items: center; }
            .tab-btn { width: 90%; text-align: center; }
            .content-section { padding: 1.25rem; }
            .header-image {
            height: 300px;
            width: auto;
            max-width: 100%;
            object-fit: contain;
            border-radius: 12px;
            margin: 1rem auto;
            display: block;
            cursor: pointer;
        }
        }
    
        /* Blur-up placeholder for perceived speed */
        .gallery-item img {
            height: 150px;
            width: auto;
            object-fit: contain;
            display: block;
            border-radius: 8px;
            cursor: pointer;
            border: 1px solid #d0d0d0; /* sottile cornice grigio chiara solo sulle miniature */
        }
        .gallery-item img.ready {
            filter: none;
        }

    </style>
    <link rel="preconnect" href="https://www.dropbox.com">
    <link rel="preconnect" href="https://dl.dropboxusercontent.com">
</head>
<body>
    <div class="header">
        <div class="container">
            <h1>Immobile per Studi Medici</h1>
            <p>Opportunit√† di Investimento - Bari, Puglia</p>
            <img class="header-image" src="https://www.dropbox.com/scl/fi/slcptm1llthu6lj8v3mcy/Copertina.jpg?rlkey=l8jydba5ghoo2wg2jgouiou21&raw=1" alt="Immobile per studi medici - Vista principale" loading="eager" fetchpriority="high" onclick="openModal('https://www.dropbox.com/scl/fi/qj8gcsyj8vqm25xo25z9o/CopertinaHD.png?rlkey=upgzutxo85scxorgb9ju30xpz&raw=1')">
        </div>
    </div>

    <div class="container">
        <div class="nav-tabs">
            <button type="button" class="tab-btn active" onclick="showSection('medici', this)">üë©‚Äç‚öïÔ∏è Per Medici</button>
            <button type="button" class="tab-btn" onclick="showSection('costruttori', this)">üèóÔ∏è Per Costruttori</button>
            <button type="button" class="tab-btn" onclick="showSection('agenzie', this)">üè¢ Per Agenzie</button>
            <button type="button" class="tab-btn" onclick="showSection('gallery', this)">üì∏ Galleria</button>
            <button type="button" class="tab-btn" onclick="showSection('documenti', this)">üìã Documenti</button>
        </div>

        <div id="medici" class="content-section active">
            <h2 class="section-title">Soluzione Ideale per il Tuo Studio Medico</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üè•</div>
                    <div class="feature-title">Spazi Funzionali</div>
                    <div class="feature-text">Ambienti progettati per studi medici e fisioterapici</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üöó</div>
                    <div class="feature-title">Parcheggio</div>
                    <div class="feature-text">Facile accesso e parcheggio per i pazienti</div>
                </div>
                <div class="feature-card" onclick="openGoogleMaps()" title="Apri in Google Maps">
                    <div class="feature-icon">üìç</div>
                    <div class="feature-title">Posizione Strategica</div>
                    <div class="feature-text">Zona centrale e ben collegata di Bari</div>
                </div>
                <div class="feature-card" onclick="window.open('https://www.dropbox.com/scl/fi/yzjj9cpl5bh69hau2gl3f/Agevolazioni_Professionisti_Medici.pdf?rlkey=itgxcpln1pcfnijctc038yakz&raw=1', '_blank')" style="cursor: pointer;">
                    <div class="feature-icon">üí∞</div>
                    <div class="feature-title">Finanziamento Agevolato</div>
                    <div class="feature-text">Possibilit√† di ottenere finanziamenti vantaggiosi</div>
                </div>
            </div>

            <div class="info-section">
                <div class="info-title">Caratteristiche dell'Immobile</div>
                <div class="info-content">
                    <div class="highlight-box">
                        <strong>‚úì Sale visite attrezzabili</strong><br>
                        ‚úì Sala d'attesa confortevole<br>
                        ‚úì Servizi igienici per disabili<br>
                        ‚úì Impianti a norma per uso sanitario<br>
                        ‚úì Possibilit√† di personalizzazione
                    </div>
                </div>
            </div>
        </div>

        <div id="costruttori" class="content-section">
            <h2 class="section-title">Opportunit√† di Sviluppo Immobiliare</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üìê</div>
                    <div class="feature-title">Progetto Flessibile</div>
                    <div class="feature-text">Spazi adattabili a diverse configurazioni</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <div class="feature-title">Autorizzazioni</div>
                    <div class="feature-text">Pratiche edilizie gi√† avviate</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üíº</div>
                    <div class="feature-title">ROI Interessante</div>
                    <div class="feature-text">Mercato sanitario in crescita</div>
                </div>
            </div>

            <div class="info-section">
                <div class="info-title">Dettagli Tecnici</div>
                <div class="info-content">
                    <div class="highlight-box">
                        <strong>Metrature:</strong> Da definire in base al progetto<br>
                        <strong>Destinazione d'uso:</strong> Sanitaria/Direzionale<br>
                        <strong>Classe energetica:</strong> A+<br>
                        <strong>Piani disponibili:</strong> Multiple opzioni<br>
                        <strong>Ascensore:</strong> Previsto nel progetto
                    </div>
                </div>
            </div>

            <div class="info-section">
                <div class="info-title">Vantaggi per Costruttori</div>
                <div class="info-content">
                    Immobile in zona ad alta richiesta di servizi sanitari. Possibilit√† di sviluppo in partnership o vendita diretta. Documentazione tecnica e autorizzazioni disponibili per valutazione approfondita.
                </div>
            </div>
        </div>

        <div id="agenzie" class="content-section">
            <h2 class="section-title">Partnership Commerciale</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">ü§ù</div>
                    <div class="feature-title">Collaborazione</div>
                    <div class="feature-text">Partnership senza esclusiva</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üí∞</div>
                    <div class="feature-title">Commissioni</div>
                    <div class="feature-text">Condizioni vantaggiose per agenzie</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìà</div>
                    <div class="feature-title">Mercato di Nicchia</div>
                    <div class="feature-text">Settore sanitario in espansione</div>
                </div>
            </div>

            <div class="info-section">
                <div class="info-title">Supporto Marketing</div>
                <div class="info-content">
                    <div class="highlight-box">
                        ‚úì Materiale fotografico professionale<br>
                        ‚úì Planimetrie e documentazione tecnica<br>
                        ‚úì Supporto per presentazioni clienti<br>
                        ‚úì Flessibilit√† nelle trattative<br>
                        ‚úì Risposta rapida alle richieste
                    </div>
                </div>
            </div>

            <div class="info-section">
                <div class="info-title">Target di Vendita</div>
                <div class="info-content">
                    Medici specialisti, fisioterapisti, centri medici, investitori immobiliari, costruttori interessati a sviluppi sanitari. Ampio ventaglio di potenziali acquirenti per massimizzare le opportunit√† di vendita.
                </div>
            </div>
        </div>

        <div id="gallery" class="content-section">
            <h2 class="section-title">Galleria Fotografica</h2>
            <!-- Aggiungi la classe 'contain' a .image-gallery qui sotto se preferisci miniature non ritagliate -->
            <div class="image-gallery" id="galleryContainer"></div>
        </div>

        <div id="documenti" class="content-section">
            <h2 class="section-title">Documentazione Tecnica</h2>
            <div class="info-section">
                <div class="info-title">Documenti Disponibili</div>
                <div class="info-content">
                    <div class="highlight-box">
                        üìã <strong>Planimetrie dettagliate</strong><br>
                        üèóÔ∏è <strong>Autorizzazioni edilizie</strong><br>
                        ‚ö° <strong>Certificazioni impiantistiche</strong><br>
                        üìä <strong>APE (Attestato Prestazione Energetica)</strong><br>
                        üìù <strong>Documentazione catastale</strong><br>
                        üîç <strong>Relazione tecnica dettagliata</strong>
                    </div>
                </div>
            </div>
            <div class="info-section">
                <div class="info-title">Richiesta Documentazione</div>
                <div class="info-content">
                    Per ricevere la documentazione completa, comprese le planimetrie tecniche e i certificati, contattaci utilizzando i riferimenti sottostanti. Tutti i documenti sono disponibili in formato digitale per una consultazione immediata.
                </div>
            </div>
        </div>

        <div class="contact-section">
            <div class="contact-title">Contattaci per Maggiori Informazioni</div>
            <div class="contact-info">
                üì± Telefono: +39 392-41.56.215<br>
                üìß Email: leonardo@infostudiopl.com<br>
                üìç Indirizzo: Via Fanelli, 6 - 70013 Castellana Grotte (BA)
            </div>
            <button class="contact-btn" onclick="window.open('tel:+393924156215')">üìû Chiama Ora</button>
            <button class="contact-btn" onclick="window.open('mailto:leonardo@infostudiopl.com')">‚úâÔ∏è Invia Email</button>
            <button class="contact-btn" onclick="window.open('https://wa.me/393924156215')">üí¨ WhatsApp</button>
        </div>
    </div>

    <div id="imageModal" class="modal" aria-hidden="true" role="dialog">
        <span class="close" onclick="closeModal()" aria-label="Chiudi">√ó</span>
        <div class="modal-content-container">
            <img class="modal-content" id="modalImage" alt="Anteprima immagine">
            <span class="prev" id="prevButton" onclick="changeImage(-1)" aria-label="Precedente">‚ùÆ</span>
            <span class="next" id="nextButton" onclick="changeImage(1)" aria-label="Successiva">‚ùØ</span>
        </div>
    </div>

    <script>
        let currentImageIndex = null;
        const images = [
"https://www.dropbox.com/scl/fi/axup1qz37h4mkfbr27s1r/IMG_9792.jpg?rlkey=lzy6l9vp5kkiurym9bgl8bk8i&raw=1",
            "https://www.dropbox.com/scl/fi/6dg7ctgm4isc5lfe5vovv/IMG_9793.jpg?rlkey=p7uvuqhgjmk97whrv6nws6n8t&raw=1",
            "https://www.dropbox.com/scl/fi/5c9d6n67gc2rcek4csyy5/IMG_9794.jpg?rlkey=762qmzkxjg5yp9v43oo10gy2a&raw=1",
            "https://www.dropbox.com/scl/fi/na64z4p9wjwd0q6o41icp/IMG_9795.jpg?rlkey=tg6sfsuv6doa0r3rxx2brfudc&raw=1",
            "https://www.dropbox.com/scl/fi/6uswkjqt8laqzkirnk65o/IMG_9796.jpg?rlkey=55z2p3nkubr3q5shl3adgre93&raw=1",
            "https://www.dropbox.com/scl/fi/0tpewlrwkgau922aowmgl/IMG_9797.jpg?rlkey=95hxu8u6rbftndr2qxyl6iwt0&raw=1",
            "https://www.dropbox.com/scl/fi/m6xmo3o5esboh8429n0rt/IMG_9798.jpg?rlkey=msr09lfqf37nv4nlp2tu0xm1o&raw=1",
            "https://www.dropbox.com/scl/fi/iw5fq9xx8fvwwp714n5qg/IMG_9799.jpg?rlkey=qbzc37aylxlo9cwhe2wmha6tq&raw=1",
            "https://www.dropbox.com/scl/fi/m7w1i6ktxspkhsin5v8fk/IMG_9802.jpg?rlkey=lfezkhhskirvewr6dyuzpx5vy&raw=1",
            "https://www.dropbox.com/scl/fi/v4wp0orsgu2buoyzdrr7e/IMG_9803.jpg?rlkey=yddga9y9xffqevfdvuekj18k3&raw=1",
            "https://www.dropbox.com/scl/fi/8hqtjoszpizhc3snf76r7/IMG_9804.jpg?rlkey=u23c9huhq4lcw523gb99bals5&raw=1",
            "https://www.dropbox.com/scl/fi/whxu9ah2sj5nawsgsd6pa/IMG_9805.jpg?rlkey=v7mfmhmdj549oe3rvgzb1whqv&raw=1"
        ,
            "https://www.dropbox.com/scl/fi/fmatftvshvwfbfmevcs9v/IMG_9806.jpg?rlkey=r6zj225238pmhrloedipqj0ji&raw=1",
            "https://www.dropbox.com/scl/fi/2137yqwsfvuut50ozyd3t/IMG_9807.jpg?rlkey=qsy1mok0uq90ax36yohdawfci&raw=1",
            "https://www.dropbox.com/scl/fi/r6lic5md0ua4q9ongjxac/IMG_9808.jpg?rlkey=lufthw51jww2dzy7kn6avp4ov&raw=1",
            "https://www.dropbox.com/scl/fi/o9vop6obc89395k14hfms/IMG_9809.jpg?rlkey=iwyoybr442jlwq4sagiv1fcp0&raw=1",
            "https://www.dropbox.com/scl/fi/rrt7q9gjsxgj8sffsfg7i/IMG_9810.jpg?rlkey=44m167nvzsiiqee48kwm88wwo&raw=1",
            "https://www.dropbox.com/scl/fi/1zbrpatyica6bjhfjfq00/IMG_9811.jpg?rlkey=xb72v36bfi9l11kqiokektenm&raw=1",
            "https://www.dropbox.com/scl/fi/doch971am77wyddl96ly9/IMG_9818.jpg?rlkey=mbt9grph1nnfcz08ybpepoys7&raw=1",
            "https://www.dropbox.com/scl/fi/3ycm1i3t1a70d1w3cc1pc/IMG_9821.jpg?rlkey=kt87osf16z8xwm9fnbrn5ngxm&raw=1",
            "https://www.dropbox.com/scl/fi/5phte5cc8egljemomcr39/IMG_9822.jpg?rlkey=28gk08gjvbm5qnpouuxybq1s3&raw=1",
            "https://www.dropbox.com/scl/fi/kpu16838tbmwx444can35/IMG_9823.jpg?rlkey=jryccy2rnnq4w51qt3skp2oy2&raw=1",
            "https://www.dropbox.com/scl/fi/y4x4uprnjzsh5dtalo6ts/IMG_9825.jpg?rlkey=j1v44zbfngx5bwiwm1x9khgyw&raw=1",
            "https://www.dropbox.com/scl/fi/w4e98zaj1jt0q4yyapm9i/IMG_9826.jpg?rlkey=6xwpjrt69ewdw716q6kd4kasv&raw=1",
            "https://www.dropbox.com/scl/fi/0qmu6e9ot0cso67m801wn/IMG_9829.jpg?rlkey=qihtedbfc56oghv1vlxya42kt&raw=1",
            "https://www.dropbox.com/scl/fi/vxctp4cluv15b9j4fk3pu/IMG_9830.jpg?rlkey=p3xcujq3iz9wreh43bv6e4o15&raw=1",
            "https://www.dropbox.com/scl/fi/x7ofi2txhdsbmfiaii9dl/IMG_9831.jpg?rlkey=22yz958pyaie3bta0wbp6qlrt&raw=1",
            "https://www.dropbox.com/scl/fi/pva6mxgsktour4gn7qpvm/IMG_9833.jpg?rlkey=12ivqoo0ruko1ouony2frrtgh&raw=1",
            "https://www.dropbox.com/scl/fi/q1fe9nka0ppcr45sr048z/IMG_9840.jpg?rlkey=seu056w3og8bdum580816rzj0&raw=1",
            "https://www.dropbox.com/scl/fi/3m32wlbdchqp6f8dgzayw/IMG_9841.jpg?rlkey=xk311dmkx6be7izueyzgp6puw&raw=1"
];

        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');

        function showSection(sectionId, btn) {
            document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            if (btn) btn.classList.add('active');
        }

        function openGoogleMaps() {
            const q = encodeURIComponent("Via Fanelli, 6, 70013 Castellana Grotte BA, Italia");
            const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${q}`;
            window.open(mapsUrl, '_blank');
        }

        function openModal(src, index = null) {
            const modal = document.getElementById('imageModal');
            const modalImage = document.getElementById('modalImage');
            if (index !== null) {
                currentImageIndex = index;
                modalImage.src = images[currentImageIndex];
                prevButton.style.display = 'block';
                nextButton.style.display = 'block';
            } else {
                currentImageIndex = null;
                modalImage.src = src;
                prevButton.style.display = 'none';
                nextButton.style.display = 'none';
            }
            modal.style.display = 'flex';
            modal.setAttribute('aria-hidden', 'false');
        }

        function changeImage(direction) {
            if (currentImageIndex !== null) {
                let newIndex = currentImageIndex + direction;
                if (newIndex >= images.length) newIndex = 0;
                if (newIndex < 0) newIndex = images.length - 1;
                currentImageIndex = newIndex;
                document.getElementById('modalImage').src = images[currentImageIndex];
            }
        }

        function closeModal() {
            const modal = document.getElementById('imageModal');
            modal.style.display = 'none';
            modal.setAttribute('aria-hidden', 'true');
        }

        window.addEventListener('click', function(e) {
            const modal = document.getElementById('imageModal');
            if (e.target === modal) closeModal();
        });

        document.addEventListener('keydown', function(e) {
            const modalOpen = document.getElementById('imageModal').style.display === 'flex';
            if (!modalOpen) return;
            if (currentImageIndex !== null) {
                if (e.key === 'ArrowLeft') changeImage(-1);
                if (e.key === 'ArrowRight') changeImage(1);
            }
            if (e.key === 'Escape') closeModal();
        });

        function generateGallery() {
            const galleryContainer = document.getElementById('galleryContainer');
            galleryContainer.innerHTML = '';

            const conn = navigator.connection || navigator.webkitConnection || navigator.mozConnection;
            const isSlow = !!(conn && (conn.saveData || /(^|-)2g$/.test(conn.effectiveType)));

            // Tiny transparent SVG placeholder
            const placeholder = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" width="4" height="3"></svg>');

            const io = 'IntersectionObserver' in window ? new IntersectionObserver((entries, obs) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        const src = img.getAttribute('data-src');
                        if (src) {
                            img.src = src;
                            img.removeAttribute('data-src');
                        }
                        obs.unobserve(img);
                    }
                });
            }, { rootMargin: '200px 0px', threshold: 0.01 }) : null;

            images.forEach((src, index) => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';

                const img = document.createElement('img');
                img.src = placeholder;             // non chiede subito l'immagine vera
                img.setAttribute('data-src', src); // carica solo quando visibile
                img.alt = `Immagine ${index + 1}`;
                img.loading = 'lazy';
                img.decoding = 'async';
                img.setAttribute('fetchpriority', isSlow ? 'low' : 'auto');
                img.onclick = () => openModal(null, index);

                img.addEventListener('load', () => {
                    // quando l'immagine reale √® caricata, togli blur
                    if (!img.hasAttribute('data-src')) img.classList.add('ready');
                });

                if (io) io.observe(img); else img.src = src; // fallback: carica subito

                galleryItem.appendChild(img);
                galleryContainer.appendChild(galleryItem);
            });
        }

        // Evita prefetch aggressivo su connessioni lente
        document.addEventListener('DOMContentLoaded', () => {
            generateGallery();
            const conn = navigator.connection || navigator.webkitConnection || navigator.mozConnection;
            const isSlow = !!(conn && (conn.saveData || /(^|-)2g$/.test(conn.effectiveType)));
            if (!isSlow) {
                // Prefetch leggero delle prossime immagini (solo quando il browser √® a riposo)
                (window.requestIdleCallback || setTimeout)(() => {
                    images.slice(0, 6).forEach(src => {
                        const l = document.createElement('link');
                        l.rel = 'prefetch';
                        l.as = 'image';
                        l.href = src;
                        document.head.appendChild(l);
                    });
                }, 1200);
            }
        });
    </script>
</body>
</html>
