<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Questionari AVIS</title>
<meta name="theme-color" content="#667eea">

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: #f5f5f5; color: #333; }
.header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1rem; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
.header-content { max-width: 1000px; margin: 0 auto; display: flex; flex-direction: column; align-items: center; gap: 0.8rem; }
.header h1 { font-size: 1.3rem; font-weight: 600; text-align: center; }
.header-buttons { display: flex; gap: 0.8rem; justify-content: center; align-items: center; }
.btn { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 0.6rem; border-radius: 6px; cursor: pointer; font-size: 1.2rem; transition: all 0.2s; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; }
.btn:hover { background: rgba(255,255,255,0.3); }
.container { max-width: 1000px; margin: 0 auto; padding: 1rem; padding-bottom: 3rem; }
.menu { display: grid; gap: 0.5rem; }
.menu-item { background: white; padding: 1rem; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: all 0.2s; }
.menu-item:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.15); transform: translateY(-2px); }
.menu-item-left { display: flex; align-items: center; gap: 0.8rem; }
.menu-item-id { font-weight: 600; font-size: 1.1rem; color: #667eea; }
.menu-item-sex { font-size: 0.85rem; color: #666; background: #f0f0f0; padding: 0.2rem 0.5rem; border-radius: 4px; }
.opt-badge { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.3rem 0.7rem; border-radius: 20px; font-size: 0.9rem; font-weight: 500; }
.detail { display: none; }
.detail.active { display: block; }
.qa-list { display: grid; gap: 0.8rem; }
.qa-item { background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); border: 1px solid #ddd; }
.qa-question { font-weight: 600; color: #667eea; margin-bottom: 0.5rem; font-size: 0.95rem; line-height: 1.4; }
.qa-answer { color: #333; font-size: 0.95rem; line-height: 1.5; padding-left: 1rem; border-left: 3px solid #667eea; }
.error-note { color: #d32f2f; font-style: italic; margin-top: 0.3rem; }

/* ERROR STYLES */
.qa-item.no-answer, 
.qa-item.multiple-answers,
.qa-item.logic-error {
    background: #ffe6e6;
    border: 1px solid #d32f2f;
}

.qa-item.no-answer .qa-answer,
.qa-item.multiple-answers .qa-answer,
.qa-item.logic-error .qa-answer {
    border-left-color: #d32f2f;
    color: #d32f2f;
}

.modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center; padding: 1rem; }
.modal-content { background: white; border-radius: 12px; padding: 2rem; max-width: 600px; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3); color: #333; }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid #667eea; }
.modal-close { background: none; border: none; font-size: 2rem; color: #999; cursor: pointer; }
</style>
</head>
<body>

<div class="header">
    <div class="header-content">
        <h1 id="title">Questionari AVIS</h1>
        <div class="header-buttons">
            <button class="btn" id="prevBtn" style="display:none" onclick="navigate(-1)">‚Üê</button>
            <button class="btn" id="homeBtn" style="display:none" onclick="goBack()">üè†</button>
            <button class="btn" id="printBtn" style="display:none" onclick="printPDF()">üñ®Ô∏è</button>
            <button class="btn" id="nextBtn" style="display:none" onclick="navigate(1)">‚Üí</button>
        </div>
    </div>
</div>

<div class="container">
    <div id="menu" class="menu"></div>
    <div id="detail" class="detail"></div>
</div>

<div id="infoModal" class="modal-overlay" onclick="closeInfoModal(event)">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h2>üìä Legenda</h2>
            <button class="modal-close" onclick="closeInfoModal()">&times;</button>
        </div>
        <p>I campi evidenziati in rosso indicano una risposta mancante o un'incongruenza logica (es. testo inserito dove non richiesto).</p>
    </div>
</div>

<script>
const allData = [{"id": "MA-ONOFRIO", "sex": "Maschio", "opt": "80% üòä", "answers": [{"q": "1. Hai mai sentito parlare di sistema trasfusionale?", "a": "No", "a_html": "No", "error": null, "is_text": false}, {"q": "2. Hai mai sentito parlare dei gruppi sanguigni?", "a": "S√¨", "a_html": "S√¨", "error": null, "is_text": false}, {"q": "3. Sai che gruppo sanguigno hai tu?", "a": "No", "a_html": "No", "error": null, "is_text": false}, {"q": "3b. Se hai risposto s√¨, sapresti dire quale?", "a": "NO", "a_html": "<strong>NO</strong>", "error": "logic-error", "is_text": true}, {"q": "4. Cosa pensi significhi 'donazione di sangue'?", "a": "Dare sangue a chi ne ha bisogno", "a_html": "Dare sangue a chi ne ha bisogno", "error": null, "is_text": false}, {"q": "5. Cosa pensi significhi 'trasfusione di sangue'?", "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a", "error": null, "is_text": false}, {"q": "6. Hai parlato di recente della donazione di sangue con qualcuno?", "a": "No", "a_html": "No", "error": null, "is_text": false}, {"q": "7. Conosci qualcuno che ha donato Sangue?", "a": "Nessuno", "a_html": "Nessuno", "error": null, "is_text": false}, {"q": "8. Conosci qualcuno che ha donato Plasma?", "a": "Non so cos'√® il plasma", "a_html": "Non so cos'√® il plasma", "error": null, "is_text": false}, {"q": "9. Secondo te quanto √® importante donare sangue?", "a": "√à molto importante", "a_html": "√à molto importante", "error": null, "is_text": false}, {"q": "10. Che cosa pensi della donazione di sangue?", "a": "√à una cosa bella", "a_html": "√à una cosa bella", "error": null, "is_text": false}, {"q": "11. Quando pensi alla donazione di sangue, come ti senti?", "a": "Felice", "a_html": "Felice", "error": null, "is_text": false}, {"q": "12. Quando pensi a qualcuno che dona, come ti senti?", "a": "Non lo so", "a_html": "Non lo so", "error": null, "is_text": false}, {"q": "13. Immaginando te da grande, cosa faresti?", "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a", "error": null, "is_text": false}, {"q": "14. Consiglieresti ad un adulto di donare sangue o plasma?", "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a", "error": null, "is_text": false}, {"q": "15. Quanto spesso giochi ai giochi da tavolo o di carte?", "a": "Quasi mai", "a_html": "Quasi mai", "error": null, "is_text": false}, {"q": "16. Quanto spesso giochi su cellulare, tablet, computer o console?", "a": "Almeno una volta a settimana", "a_html": "Almeno una volta a settimana", "error": null, "is_text": false}, {"q": "17. Giochi pi√π spesso a:", "a": "Giochi in cui devi muoverti", "a_html": "Giochi in cui devi muoverti", "error": null, "is_text": false}, {"q": "18. Preferisci:", "a": "Giochi in cui devi muoverti", "a_html": "Giochi in cui devi muoverti", "error": null, "is_text": false}, {"q": "19. Preferisci giochi in cui:", "a": "Risolvere enigmi, Scoprire cose", "a_html": "Risolvere enigmi, Scoprire cose", "error": null, "is_text": false}, {"q": "20. Scrivi il nome dei 3 giochi a cui giochi pi√π spesso", "a": "JUST DANCE, MARIO KART, ANIMAL CROSSING", "a_html": "<strong>JUST DANCE, MARIO KART, ANIMAL CROSSING</strong>", "error": null, "is_text": true}, {"q": "21. Cosa nel sangue √® giallo, liquido e ricco di nutrienti?", "a": "Globulo bianco", "a_html": "Globulo bianco", "error": null, "is_text": false}, {"q": "22. Quali sono i gruppi sanguigni?", "a": "Plasma, sangue e globuli rossi", "a_html": "Plasma, sangue e globuli rossi", "error": null, "is_text": false}, {"q": "23. Chi tra queste persone pu√≤ donare sangue?", "a": "Simone di 16 anni", "a_html": "Simone di 16 anni", "error": null, "is_text": false}, {"q": "24. Quale gruppo sanguigno pu√≤ donare sangue a pi√π gruppi?", "a": "AB", "a_html": "AB", "error": null, "is_text": false}, {"q": "25. Cosa √® AVIS?", "a": "Assistenza Volontari Sangue", "a_html": "Assistenza Volontari Sangue", "error": null, "is_text": false}, {"q": "26. Chi sono i donatori di sangue?", "a": "Persone comuni volontarie", "a_html": "Persone comuni volontarie", "error": null, "is_text": false}, {"q": "27. Quando √® utilizzato il sangue donato?", "a": "Emergenze, operazioni e terapie", "a_html": "Emergenze, operazioni e terapie", "error": null, "is_text": false}, {"q": "28. In questi ultimi giorni, quanto sei felice?", "a": "üòÑ Molto felice", "a_html": "üòÑ Molto felice", "error": null, "is_text": false}, {"q": "29. Quanto sei soddisfatta/o della tua vita a scuola?", "a": "üòÑ Molto soddisfatta/o", "a_html": "üòÑ Molto soddisfatta/o", "error": null, "is_text": false}, {"q": "30. Quanto sei contenta/o della tua vita a casa?", "a": "üòÑ Molto contenta/o", "a_html": "üòÑ Molto contenta/o", "error": null, "is_text": false}, {"q": "31. Biglietti regalo (0-10)", "a": "10", "a_html": "<strong>10</strong>", "error": null, "is_text": true}], "pdf_data": "JVBERi0xLjQKJZOMi54gUmVwb3J0TGFiIEdlbmVyYXRlZCBQREYgZG9jdW1lbnQgKG9wZW5zb3VyY2UpCjEgMCBvYmoKPDwKL0YxIDIgMCBSIC9GMiAzIDAgUiAvRjMgNCAwIFIgL0Y0IDUgMCBSCj4+CmVuZG9iagoyIDAgb2JqCjw8Ci9CYXNlRm9udCAvSGVsdmV0aWNhIC9FbmNvZGluZyAvV2luQW5zaUVuY29kaW5nIC9OYW1lIC9GMSAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjMgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtQm9sZCAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjIgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago0IDAgb2JqCjw8Ci9CYXNlRm9udCAvWmFwZkRpbmdiYXRzIC9OYW1lIC9GMyAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjUgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtT2JsaXF1ZSAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjQgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago2IDAgb2JqCjw8Ci9Db250ZW50cyAxMCAwIFIgL01lZGlhQm94IFsgMCAwIDU5NS4yNzU2IDg0MS44ODk4IF0gL1BhcmVudCA5IDAgUiAvUmVzb3VyY2VzIDw8Ci9Gb250IDEgMCBSIC9Qcm9jU2V0IFsgL1BERiAvVGV4dCAvSW1hZ2VCIC9JbWFnZUMgL0ltYWdlSSBdCj4+IC9Sb3RhdGUgMCAvVHJhbnMgPDwKCj4+IAogIC9UeXBlIC9QYWdlCj4+CmVuZG9iago3IDAgb2JqCjw8Ci9QYWdlTW9kZSAvVXNlTm9uZSAvUGFnZXMgOSAwIFIgL1R5cGUgL0NhdGFsb2cKPj4KZW5kb2JqCjggMCBvYmoKPDwKL0F1dGhvciAoXChhbm9ueW1vdXNcKSkgL0NyZWF0aW9uRGF0ZSAoRDoyMDI2MDIwNTIxMTIxMCswMScwMCcpIC9DcmVhdG9yIChcKHVuc3BlY2lmaWVkXCkpIC9LZXl3b3JkcyAoKSAvTW9kRGF0ZSAoRDoyMDI2MDIwNTIxMTIxMCswMScwMCcpIC9Qcm9kdWNlciAoUmVwb3J0TGFiIFBERiBMaWJyYXJ5IC0gXChvcGVuc291cmNlXCkpIAogIC9TdWJqZWN0IChcKHVuc3BlY2lmaWVkXCkpIC9UaXRsZSAoXChhbm9ueW1vdXNcKSkgL1RyYXBwZWQgL0ZhbHNlCj4+CmVuZG9iago5IDAgb2JqCjw8Ci9Db3VudCAxIC9LaWRzIFsgNiAwIFIgXSAvVHlwZSAvUGFnZXMKPj4KZW5kb2JqCjEwIDAgb2JqCjw8Ci9GaWx0ZXIgWyAvQVNDSUk4NURlY29kZSAvRmxhdGVEZWNvZGUgXSAvTGVuZ3RoIDI1OTAKPj4Kc3RyZWFtCkdhdWBWOWxvJksnIyFVNG9PVFBFUF83bTVqQlQtYDlUbyk4YChobE5TOiNsOj1OMipfLWo4ZDZqayJGJVBYTzhBQjk0aS1Ab2xlX1FkZzgpaDw4YkssNjgyaWFSSFpSIThhZzhvbTZhbl9XaSRGN2lZUkVfN1M3V2I1dVpLXV09X1tKNGNPXT0zdGgjJVBYaEorQiQ+cDZuJltJNkB0OmlRRiVwYSlSdDcsKzpzJVdjIW1uUEpadXUlNV1VTjljIltLNyElZWNCUCJSMi82XDcpdVdzMm5GQitNXnVqRjJeMklpa3E9IlJ0c0JlYlJub3FocnFwaUE3TyRdLVpJVmIyS1pEKCZ1JCgoQmddQ3FYMktyKypGTiJYOVo2XDhjY1JaY0BmUy9vLnEqVSspa2luX3VxWVAhUTlhUEotbz1ULDJxUCFKZmspJG1vLmIxQTAoWU5fZkM9XG4sajIucFopcEpFPGNpdTgjVG8jUG9MVDorRyFcO2U/Rk1NXWE6OCY6OkpmbGFtWi0jXD4zKj8jTkpMWTN0SnBrSSVyYy1sLEw2WWd0Qyo8YEwiUVsyRmdYb1UtTTskIkI/KTctM2hHNWlVNEk+Slc9JV41aypdXiFXPFRybjFTWFBkMiU9UlNhQU9VRl4rMV9edE0sWlRlaFtfWTE7TEIlcmh1YnE8J25nTyE+PlEmVkI2VytpMHQ9IksnY1BaXVpYWjRTJm1GRUo5Jm9mVWBdTVxmZ00uIVlxYG5ONTM/X01bcjAjP3RiJ19MMWotcWk1LC5gZnIjZmU7UTpecWUqZXUuLzhYJGhdPHIzV2dbb1tMQ15TcWUwT2ArRlllQFxbSmdXKystKShKNFxIbk4qNzpqXGEpJGpqXFFKK1pKQG4oTTtKUXJeRWctWEM9RSVHUTw7bTV0cywkSVUhOGwhP0EiRVQvP0FuO2EwWTdOODBeaCU8IWVxX088TGlJTUY2I1lNRnFkPThGIigxbzNvSEBxIjgwUl42WStVWjFKUm0lMzVKMC9cTl4iWmA0Q3BbMSxpYG8nWjgiZypgXnBCPzNKK18oQlw0ND5AWTNHckhZb2YmJFNVKWZsIzUuYjBsdEFIMl9QZmIoNTdcZDtgUSchUV5HYjNWKlJJOmpeTUsxUG1yMyYnI0lyaCdKVihxXE5EJCdKXWFeWzNCU0lWb1lhXV1KKCw5PitKRWJCLWQwJEBJZGtXTVlaOVRXZi9hJzk2J3JBSkNfIjVeYVRBZGpFcmIwW0RHY0ZqRj08Y1BPJldUY01CKkQ0OWpNT1pqP3U4cGEwcC1gJnJwRWJXZDxoQTRNc2dMVys6QlhxV0VRIU1OR0JdXmEyS0UqQkpwZio8UiU7SmIsU0BZaWcpK1s1VD8xU1ZRPUJIaltzc1VKX0FcS2sxb2FUOT00U1FcXS0wKzRsYCMqLGVhblwxW2NCbFZGbnVOREFGTlFVbC5eV0M7IkI0QitNV1w3PlluWF5PPEw4Ol9vcTAjX1h0NCJDUzc2PiNLO2JMa3JWaFE4cV82U21hYCYqJkQ2WGAkOWFBPWUlamdEQFsvNTs2NF9gbF1qV3FeIUkoKUlJXmYlXGFYQyUmbFM8ZiQjcTEmYSlUS0F0RUI1RGY5KSc1Py1KZUYrIkRtPCRCSkFhTXJcdG9TRGxhVS5QR08mUWUoMUk2SzVVNy8zSU5HVFFTXl88NS5GcGBHcFU6Q3IhYVEjQChRXSxQWD4rKHVnWlUual89X2c+PjouTyIubTVuSmxraytaMDE8M1dAKzRIIk9eT1NcaFgrP0pJV1lnLDhnNyZYP0pUXzhwMC5QPjlZLk86TGNhZXFOTjV0LihkVC5nREc5cXNZdSVJRCtEWUA1bXBbaVdDS0JYbFgyJ2ZVaGJiUmhWVURmImw2PVdlbStEIWFBXyFgPlxAWWU+Ty5MVGBES1VhdVkiZVE0XlNfbkZZKl07X25NN2dhUE9dYFl0OUElYyskcWlxdXFYcCRocSJcMVozQDdDbC9yL0heSyQ7aiJBT1ddVVYmZytdRGs4YWpgaytYaXNmcFdJN0NvaV1sPz5dSCplZiRTdGxZQCNgQi5EX1wuRmplXk4tSXEjb2AoUDEqSlEiWV9RbFNKVGZucylxdVMrIlZfbjpgNCJsXmxZVEoxaTlPN0M0UCdkXC9eOGFtZFBfPG8yUjItOVhxNUVqOnBwPCZPTVIwYi8mRnMhJzMybWtXcjZRUEFxUlkuSytkZkY9TkhQV0s2VywwSVY2Y14nPFsmSTRSTjBAOCtvIWImQTg8aWQsJ3VRPVQrYF0tNV9ZWSFqMEtUW0pab1dhNSdHJlcoN08rO1JeUGpLJzlqVi8zUjwrKEFscDQyKCEzTGInYVIiMmsxWzEjPDsoJGxWbzpJNztoJ1BgJC01Nj9lUlVuPkRGTV5bL0ZUcGpcRjEtVzFRIy1KMllkLiJaailKcVMmUU1lWkxaYS44ZHBzcS0zOz1RbyR0Uio6QUtjViJPIWdRW2wyTjM+XHJyKjo8M29GRzZrayssOG9bKkgkR1hUN0lUOjdvZnBWN3IsUWlPcD4lSE40TG1GN0xPWXEkWEgpOSNtLkI+W0R0KkpbSSg7QCZxaUNrbyg/b1Y/VDJHSFpBMSVGPDtzdWZvQDNXKGBcdXR1ZGVGbE9SZixiQC1bXTUoImFScmhTXk9KVj9ZaGlIdVNzUUVrSig8LWxZLGxlSDhvVyJMTUc8ZSNXYV4oXys0a10mXTczNDw1TidYNEtUMEtvaiphSDhmRjZoRkJSTC1tS2pjO0tDcEtbMSNHV2kxakQ5MzciTVZmJT5tdE9EKXJhOCFnS3VeLTtlTWc8XHI4RHNkUGVfaidUbyZaOS1KZCslO2A+QjtaaWVCTjtRMGVES3ErZ2QoOjM5XC40SEYtLEQpTC0qV1JsJC1VUjtKUEc4XzhtbGBvIlY3UnM1Ml9cbUIxQi9sLFJkSWBcU2lDOHBVLDQ5RFhDMkI5KXBgLiEmaU5WLiJHL1RrKmZTQSslPEBrNSRqREQ/I2hFJVQ2PydvbmtKUmhdXC8+K1ZwSVZnbm9fMS87dSowUTBSYicwXV5LWlJeTzsjbFVIUzY0VUdFTiZPQWtecmY5Z19rZ2MnOV9JVltZJ002TEJcMVRmTjJcNyRgU0NVMFIwcjFYQEg7YD5JcCRbcGphQidCLnNCOTJlNUEyImUlIzZjQmwnLGZvOE8rWmpbL3RLPD0vQHNITElTU15XUUlFcSJgOCVcKmdNajosOjs/S2FvcypnP2d0SGJKPFY9KipOV01GMmJjI2ZIalBOPWohYWxjRUNwS1sxIStZZXEla0AkL2l1V0QwVipibW8pOSZlQXJXdVFAbExTW3Nsc04mUSMwJHEjMmhVVkpGbiQnRU5OUEVMKm9VMCc/aUg6b2VgV2w7JXUoSnE1P0pGM3JyWmpxJjtMfj5lbmRzdHJlYW0KZW5kb2JqCnhyZWYKMCAxMQowMDAwMDAwMDAwIDY1NTM1IGYgCjAwMDAwMDAwNjEgMDAwMDAgbiAKMDAwMDAwMDEyMiAwMDAwMCBuIAowMDAwMDAwMjI5IDAwMDAwIG4gCjAwMDAwMDAzNDEgMDAwMDAgbiAKMDAwMDAwMDQyNCAwMDAwMCBuIAowMDAwMDAwNTM5IDAwMDAwIG4gCjAwMDAwMDA3NDMgMDAwMDAgbiAKMDAwMDAwMDgxMSAwMDAwMCBuIAowMDAwMDAxMDkxIDAwMDAwIG4gCjAwMDAwMDExNTAgMDAwMDAgbiAKdHJhaWxlcgo8PAovSUQgCls8NzkxZWYzZmFlNmJkNWZlODI1NjczNGM0NzZmN2U1MzI+PDc5MWVmM2ZhZTZiZDVmZTgyNTY3MzRjNDc2ZjdlNTMyPl0KJSBSZXBvcnRMYWIgZ2VuZXJhdGVkIFBERiBkb2N1bWVudCAtLSBkaWdlc3QgKG9wZW5zb3VyY2UpCgovSW5mbyA4IDAgUgovUm9vdCA3IDAgUgovU2l6ZSAxMQo+PgpzdGFydHhyZWYKMzgzMgolJUVPRgo="}, {"id": "MA-TERESA", "sex": "Femmina", "opt": "72% üòä", "answers": [{"q": "1. Hai mai sentito parlare di sistema trasfusionale?", "a": "No", "a_html": "No", "error": null, "is_text": false}, {"q": "2. Hai mai sentito parlare dei gruppi sanguigni?", "a": "No", "a_html": "No", "error": null, "is_text": false}, {"q": "3. Sai che gruppo sanguigno hai tu?", "a": "No", "a_html": "No", "error": null, "is_text": false}, {"q": "3b. Se hai risposto s√¨, sapresti dire quale?", "a": "(nessuna risposta)", "a_html": "<span style=\"color:#999; font-style:italic;\">(nessuna risposta)</span>", "error": null, "is_text": true}, {"q": "4. Cosa pensi significhi 'donazione di sangue'?", "a": "Dare sangue a chi ne ha bisogno", "a_html": "Dare sangue a chi ne ha bisogno", "error": null, "is_text": false}, {"q": "5. Cosa pensi significhi 'trasfusione di sangue'?", "a": "Trasferire sangue in una persona", "a_html": "Trasferire sangue in una persona", "error": null, "is_text": false}, {"q": "6. Hai parlato di recente della donazione di sangue con qualcuno?", "a": "S√¨", "a_html": "S√¨", "error": null, "is_text": false}, {"q": "7. Conosci qualcuno che ha donato Sangue?", "a": "Nessuno", "a_html": "Nessuno", "error": null, "is_text": false}, {"q": "8. Conosci qualcuno che ha donato Plasma?", "a": "Non so cos'√® il plasma", "a_html": "Non so cos'√® il plasma", "error": null, "is_text": false}, {"q": "9. Secondo te quanto √® importante donare sangue?", "a": "√à molto importante", "a_html": "√à molto importante", "error": null, "is_text": false}, {"q": "10. Che cosa pensi della donazione di sangue?", "a": "√à una cosa brutta", "a_html": "√à una cosa brutta", "error": null, "is_text": false}, {"q": "11. Quando pensi alla donazione di sangue, come ti senti?", "a": "Triste", "a_html": "Triste", "error": null, "is_text": false}, {"q": "12. Quando pensi a qualcuno che dona, come ti senti?", "a": "Felice", "a_html": "Felice", "error": null, "is_text": false}, {"q": "13. Immaginando te da grande, cosa faresti?", "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a", "error": null, "is_text": false}, {"q": "14. Consiglieresti ad un adulto di donare sangue o plasma?", "a": "S√¨", "a_html": "S√¨", "error": null, "is_text": false}, {"q": "15. Quanto spesso giochi ai giochi da tavolo o di carte?", "a": "Almeno una volta al mese", "a_html": "Almeno una volta al mese", "error": null, "is_text": false}, {"q": "16. Quanto spesso giochi su cellulare, tablet, computer o console?", "a": "Almeno una volta a settimana", "a_html": "Almeno una volta a settimana", "error": null, "is_text": false}, {"q": "17. Giochi pi√π spesso a:", "a": "Giochi in cui devi muoverti", "a_html": "Giochi in cui devi muoverti", "error": null, "is_text": false}, {"q": "18. Preferisci:", "a": "Giochi in cui devi pensare", "a_html": "Giochi in cui devi pensare", "error": null, "is_text": false}, {"q": "19. Preferisci giochi in cui:", "a": "Scoprire cose", "a_html": "Scoprire cose", "error": null, "is_text": false}, {"q": "20. Scrivi il nome dei 3 giochi a cui giochi pi√π spesso", "a": "UNO, MONOPOLY, ROBLOX", "a_html": "<strong>UNO, MONOPOLY, ROBLOX</strong>", "error": null, "is_text": true}, {"q": "21. Cosa nel sangue √® giallo, liquido e ricco di nutrienti?", "a": "Globulo bianco", "a_html": "Globulo bianco", "error": null, "is_text": false}, {"q": "22. Quali sono i gruppi sanguigni?", "a": "A, B, C, D", "a_html": "A, B, C, D", "error": null, "is_text": false}, {"q": "23. Chi tra queste persone pu√≤ donare sangue?", "a": "Simone di 16 anni", "a_html": "Simone di 16 anni", "error": null, "is_text": false}, {"q": "24. Quale gruppo sanguigno pu√≤ donare sangue a pi√π gruppi?", "a": "C", "a_html": "C", "error": null, "is_text": false}, {"q": "25. Cosa √® AVIS?", "a": "Assoc. Vaccinati Italiani Sanitari", "a_html": "Assoc. Vaccinati Italiani Sanitari", "error": null, "is_text": false}, {"q": "26. Chi sono i donatori di sangue?", "a": "Persone comuni volontarie", "a_html": "Persone comuni volontarie", "error": null, "is_text": false}, {"q": "27. Quando √® utilizzato il sangue donato?", "a": "Solo emergenze al pronto soccorso", "a_html": "Solo emergenze al pronto soccorso", "error": null, "is_text": false}, {"q": "28. In questi ultimi giorni, quanto sei felice?", "a": "(nessuna risposta)", "a_html": "(nessuna risposta)", "error": "no-answer", "is_text": false}, {"q": "29. Quanto sei soddisfatta/o della tua vita a scuola?", "a": "üòÑ Molto soddisfatta/o", "a_html": "üòÑ Molto soddisfatta/o", "error": null, "is_text": false}, {"q": "30. Quanto sei contenta/o della tua vita a casa?", "a": "üòÑ Molto contenta/o", "a_html": "üòÑ Molto contenta/o", "error": null, "is_text": false}, {"q": "31. Biglietti regalo (0-10)", "a": "10", "a_html": "<strong>10</strong>", "error": null, "is_text": true}], "pdf_data": "JVBERi0xLjQKJZOMi54gUmVwb3J0TGFiIEdlbmVyYXRlZCBQREYgZG9jdW1lbnQgKG9wZW5zb3VyY2UpCjEgMCBvYmoKPDwKL0YxIDIgMCBSIC9GMiAzIDAgUiAvRjMgNCAwIFIgL0Y0IDUgMCBSCj4+CmVuZG9iagoyIDAgb2JqCjw8Ci9CYXNlRm9udCAvSGVsdmV0aWNhIC9FbmNvZGluZyAvV2luQW5zaUVuY29kaW5nIC9OYW1lIC9GMSAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjMgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtQm9sZCAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjIgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago0IDAgb2JqCjw8Ci9CYXNlRm9udCAvWmFwZkRpbmdiYXRzIC9OYW1lIC9GMyAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjUgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtT2JsaXF1ZSAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjQgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago2IDAgb2JqCjw8Ci9Db250ZW50cyAxMCAwIFIgL01lZGlhQm94IFsgMCAwIDU5NS4yNzU2IDg0MS44ODk4IF0gL1BhcmVudCA5IDAgUiAvUmVzb3VyY2VzIDw8Ci9Gb250IDEgMCBSIC9Qcm9jU2V0IFsgL1BERiAvVGV4dCAvSW1hZ2VCIC9JbWFnZUMgL0ltYWdlSSBdCj4+IC9Sb3RhdGUgMCAvVHJhbnMgPDwKCj4+IAogIC9UeXBlIC9QYWdlCj4+CmVuZG9iago3IDAgb2JqCjw8Ci9QYWdlTW9kZSAvVXNlTm9uZSAvUGFnZXMgOSAwIFIgL1R5cGUgL0NhdGFsb2cKPj4KZW5kb2JqCjggMCBvYmoKPDwKL0F1dGhvciAoXChhbm9ueW1vdXNcKSkgL0NyZWF0aW9uRGF0ZSAoRDoyMDI2MDIwNTIxMTIxMCswMScwMCcpIC9DcmVhdG9yIChcKHVuc3BlY2lmaWVkXCkpIC9LZXl3b3JkcyAoKSAvTW9kRGF0ZSAoRDoyMDI2MDIwNTIxMTIxMCswMScwMCcpIC9Qcm9kdWNlciAoUmVwb3J0TGFiIFBERiBMaWJyYXJ5IC0gXChvcGVuc291cmNlXCkpIAogIC9TdWJqZWN0IChcKHVuc3BlY2lmaWVkXCkpIC9UaXRsZSAoXChhbm9ueW1vdXNcKSkgL1RyYXBwZWQgL0ZhbHNlCj4+CmVuZG9iago5IDAgb2JqCjw8Ci9Db3VudCAxIC9LaWRzIFsgNiAwIFIgXSAvVHlwZSAvUGFnZXMKPj4KZW5kb2JqCjEwIDAgb2JqCjw8Ci9GaWx0ZXIgWyAvQVNDSUk4NURlY29kZSAvRmxhdGVEZWNvZGUgXSAvTGVuZ3RoIDI1ODYKPj4Kc3RyZWFtCkdhdUhOZ01ZZSsmcTA1UFcwXXE4SlEoTnVkXyUtdDlUbVhFTTNHR15ZUkM1WzxtcidBLGRPMiciNkFiYTwqcD5kQ18mPiFAS1olUWQ5VGE3TFREdVYmSHI0PWtrTVclISlBbU1yIlRDWEAhTW9UVFJjLS5HZSUoLD1lR2EvVjRiMHEvPylaOjZiP1pMK0o5KyFackE/bTtCalJmSlEvUj88YDNUXz5XbEBoTHFpPicwajgzVHEuTycuZzAkWEdtUiFTXiRLT01bIlU0ITkibTwrK2k7Im1QbFVzYkkoS2dcKiVWblE3bW5USCs/W2Q8SElQUUBfcS9rZENZLGBPLDkhSilzQGoqW0RjS1BlWTgkP2FYMyxcZExXN0NzSGYlW0A2WG8vdGtxWmhOMyE0Y1g6VFJeTCEiJ0cmVTskRVJ1MC45SGZINSE4aV9XcFgqKVU5Lz9gdWhoaV0jVGhfTUNbJnBtUWNlMi8tUkpxNVk2NEJvc2ZPNUtDKnQkXVAxWiVQPFtvb19aYU5nPzxfPlBkZyVRbyp1YFY/YXUlXURwOkQmZj5eVFpvQ15YM0c7W2xvJVBZPFUrUl5hXmQlIVZfXyFjMUxSIlxNNWNgb3JJM19TOyVeYF0zMWBtcC4jQ0Eob1lEKDAxbytmQ2NSLGQnb21hKVMzRzNnQV5cNUkhOCgvKSxhKVovamAwRFdAMUhEImxVYiNOOjs2ZG4wXiViPW4iUXVuOSUlVWhbOnVXK1pQMjFZRmYtXjQrVFghOVE9U2hqWmw8J24kQz1DMTBXcl9McEk8dFtncSFWWWg7IyJOKmQqNW05TChRbkx0UCVJTiRwLitkNT08S3NpSEpROC1FazVhcyFnKVtGbytdMSJVdE86Q140MzlaLCNKPF9Ub2c2RmwxQCY0IWxLI3VbRygpLk1CQUpUZUwmXktkIkFhP3Ala2tZOzgiZGUzYzNqV08xaWUqTTMvVVNHYUVlZSotZFIncUoiWkV0MWdyMyxBJ25cSUJmWl87Zi4xcE11PmM/PzYtTm1SVzlFdDdxX01jYllmTkAlTUkoZjdBYiNQJlM0QlZpK146RTEyTSosWyVxXWwyaz1mQWhhU1JcbCcoNmRKJzImTS1IcTcnQV1kV0shYycrVFVGKGlsTDJcWDhKYV5wNUBqJU9VOE05TUYiLjglQjBEViddYWAvc1wzdGdVYDRSazk2RlVOR1o7YzloSTVWI3FhPFFhPDIqcTYyNk0nNixmRDw8U0p1YjxuOUgmZk5WUyFqcEcudFhwczArM2hRaTdMM0VBLE5hZkdzInM0SVsmZ11vQkdSZm5eQSleMk89RDYzS2M6KkNfIWtDTWUnOT4waDNoP1sjXSNxaTFkXWpYPWhHVl0qMyQ1dDRfLSVDJVY1LjdvbjVwRz0xNjwlUyJsXSZdYnJDbDJlXU5EYm5YIUAtVyhrbTInV2FsXzknQXFYXVNBKykndFBiLz5TOyE1Q3JTRzRfTjc7XDNFb2s6JF04LGYvOkRwYXFrLEc2PElmUGJHJ2tCPl1BUjk3Zz43ZTEtWEhsSykqITBQWHBYNyZiZ1AzUEUoWmMwRldcPlUtbV0iVl0kUmQrcWNqW0hVPChkTTtoRk11RjNOXiM2QDxeXzpJMVVlLGIzIm5rZjghMmBjZyNGSUBrSFkzK0ZAWTNTUjhZUHBLPUprVislXzUiNTYrUiE4Vj5kJG9CRDVEQ1hFKEFjaGozLlY/OThDV1UhNEgzL1dDOENYIzhFNjJNVFUtUlQzOiJdZjRoRDElYm1HIlJwYCQuPkpWKSNxPStPR11HI1xuN11ZbS8sZmZGUk8naFRnWkZTcUBKXVAvOmpHKCwqLmsnJHBuZihkZSphI2FCKUIiUy9CSjUmIiRVPD9kVmYzQEhqJiglayVCWidGcD5YUVs5VjNKPVpwSmFkcjw8JD9VSiouMDImTD1fNyxfYj5dMzI1RlpmUVY0PTQxaCVDUWteI05iXERzYURXUGNlPm1TJUhqP08qMEZyaW48OyhSMCpJbnVuMS0+Iz1BUF1KQ3RUckU6bCkzRVVzJztuIzVnTjxQSjAjVXR0RVZqcjEiMjI1VEZiI1UzYi1aUmhuWU0yOy1zO2pacy5qUDYlcUdGSyVXdV4qZUJsaSMrV2pRMmokOTZdYEMzJ2hPWFw9N21hPWJZNF8vWDo8NDhyYjMrWTouaEhcWD8rNyRhVGtcVV1fSGRHVilIbCg1TkY7ZWpKYnBZQnMiLmVoK2Y5aGY1S09VbD5BJFswbD82WTsiOjYqZXQmUktCKWZzaEVtbCgwOW9DSTNgOj1RbF9ANHBwZ2MmQypYI2AjZWEuNXI0MTBnXCo2QyY7bHRhT28lbnRNKzE1c2MpWWF0I1RtNGgtWFUwQG1STVBDU2wqKTEiNkoxLFJGV18nMG9yK2ZnITsnXGRJTVhHcElUIzBsa0lNc2w8IS5LZlNpMkMuUWlnTC1lSXJcPVU0Z2FWKD4oSWNFI04lXS9XLklaJ2daKStbOHJdRUwzZnI4MiNJUF9rUnBLPkdCPTBuJ0AkUWg6X1wzJXFmaFxIT1FPbDo+X1pBLVJGRks3J0ZeXTdhWy5BaDY+ZWtISl9cXlVSbmtMRldITDlHJGJIXyQ9S1FNPEFqSjVJY3QjMW5CR2Erb2VAQjttM0dZZGJGb0RibCY7ZkRbX2IvbGY0NytAcVNmbztoVilpODNeOUAxKzYoQmtHYiNobGtxVGgxTD5QbyxjRCMvTXArcEdmTjVySnRNcEhzaVFoVzdtaDhyLCUyVCNdIi85UzBXN0AtbSozZDhoZF4taVxRbXAxaEo9Z1k5UElTTUpRTTx1cTFpdDckWGNqLW8jcmVJWSpIUl1ZMWFYQ2A2OEZTTnFOJkAkTC10Qk5xXGlYTyJwXXNxLlJNYzowUEhHOS5fQjVZVFMyXC02Mm5jMl1uTGoqPlh1QzQ3Vk9wSCdSZD1cOlpDJz9YUzZdSVlsO3FoTVBVJkU0ajpual9tKl0vU1JfY1VcOWFzOlxUJFV1bSxbcWVcazdrMWc0cSpVcFNOY1xLRzJMIyZtRWNrN1NMa11jIlFXT2NjSm5vSDJSWm1xczM4T2FjREQnMlVhJmk9Qk4oQVRSP1hlcElSWVdBJ2FTYVVbYipWWGxKPUMuRHI1a2JdR0RBR2xlbE5KWC9Cb1Y7cC1ZWCgzOEokRSUyQCRwQjJpYm5RPT1jJl42dFwqVU10PVo8MCtdZFZSLG9YLU4iUjldKT8mQDQqTXRLN1JnSSpFSDAtVyNxLE9WW3RaTD1SU14qcEk4W0IhUilhJjolZ0IjPitGQytURi9FQnJiX2NlZGo7aSY7OislNjU2Wz4xSTMqKlwrNypYKVtRJF04KlZHWjJPLG0mPDljYDBPTGNoRlhqZXRDOWJkb1osVF1ERCc9U3M4YTQ6Ryp+PmVuZHN0cmVhbQplbmRvYmoKeHJlZgowIDExCjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDA2MSAwMDAwMCBuIAowMDAwMDAwMTIyIDAwMDAwIG4gCjAwMDAwMDAyMjkgMDAwMDAgbiAKMDAwMDAwMDM0MSAwMDAwMCBuIAowMDAwMDAwNDI0IDAwMDAwIG4gCjAwMDAwMDA1MzkgMDAwMDAgbiAKMDAwMDAwMDc0MyAwMDAwMCBuIAowMDAwMDAwODExIDAwMDAwIG4gCjAwMDAwMDEwOTEgMDAwMDAgbiAKMDAwMDAwMTE1MCAwMDAwMCBuIAp0cmFpbGVyCjw8Ci9JRCAKWzxiM2RjMmVlZTc5MzhmMGVjNTQyODM0NDU0MDM3ODUyOT48YjNkYzJlZWU3OTM4ZjBlYzU0MjgzNDQ1NDAzNzg1Mjk+XQolIFJlcG9ydExhYiBnZW5lcmF0ZWQgUERGIGRvY3VtZW50IC0tIGRpZ2VzdCAob3BlbnNvdXJjZSkKCi9JbmZvIDggMCBSCi9Sb290IDcgMCBSCi9TaXplIDExCj4+CnN0YXJ0eHJlZgozODI4CiUlRU9GCg=="}];
let currentIndex = -1;

function renderMenu() {
    const menu = document.getElementById('menu');
    menu.innerHTML = '';
    allData.forEach((item, idx) => {
        const div = document.createElement('div');
        div.className = 'menu-item';
        div.onclick = () => showDetail(idx);
        div.innerHTML = `
            <div class="menu-item-left">
                <span class="menu-item-id">${item.id}</span>
                <span class="menu-item-sex">${item.sex}</span>
            </div>
            <span class="opt-badge">${item.opt}</span>
        `;
        menu.appendChild(div);
    });
}

function showDetail(idx) {
    currentIndex = idx;
    const item = allData[idx];
    document.getElementById('title').innerText = `${item.id} ‚Ä¢ ${item.opt}`;
    document.getElementById('prevBtn').style.display = 'block';
    document.getElementById('homeBtn').style.display = 'block';
    document.getElementById('printBtn').style.display = 'block';
    document.getElementById('nextBtn').style.display = 'block';
    document.getElementById('menu').style.display = 'none';
    const detail = document.getElementById('detail');
    detail.className = 'detail active';
    
    let html = '<div class="qa-list">';
    item.answers.forEach(ans => {
        const errorClass = ans.error ? ans.error : '';
        const answerText = ans.a_html || ans.a;
        html += `
            <div class="qa-item ${errorClass}">
                <div class="qa-question">${ans.q}</div>
                <div class="qa-answer">${answerText}</div>
            </div>
        `;
    });
    html += '</div>';
    detail.innerHTML = html;
}

function goBack() {
    currentIndex = -1;
    document.getElementById('title').innerText = 'Questionari AVIS';
    document.getElementById('prevBtn').style.display = 'none';
    document.getElementById('homeBtn').style.display = 'none';
    document.getElementById('printBtn').style.display = 'none';
    document.getElementById('nextBtn').style.display = 'none';
    document.getElementById('menu').style.display = 'grid';
    document.getElementById('detail').className = 'detail';
}

function navigate(direction) {
    const max = allData.length - 1;
    if (max < 0) return;
    let newIdx = currentIndex + direction;
    if (newIdx < 0) newIdx = 0;
    if (newIdx > max) newIdx = max;
    showDetail(newIdx);
}

function printPDF() {
    const item = allData[currentIndex];
    if (!item.pdf_data) { alert('PDF non disponibile.'); return; }
    const byteCharacters = atob(item.pdf_data);
    const byteNumbers = new Array(byteCharacters.length);
    for (let i = 0; i < byteCharacters.length; i++) { byteNumbers[i] = byteCharacters.charCodeAt(i); }
    const byteArray = new Uint8Array(byteNumbers);
    const blob = new Blob([byteArray], { type: 'application/pdf' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Questionario_${item.id}.pdf`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
}

document.addEventListener('keydown', e => {
    if (currentIndex >= 0) {
        if (e.key === 'ArrowRight') navigate(1);
        if (e.key === 'ArrowLeft') navigate(-1);
        if (e.key === 'Escape' || e.key === 'Home') goBack();
    }
});

renderMenu();
</script>
</body>
</html>
    