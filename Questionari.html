<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Questionari AVIS</title>
<meta name="theme-color" content="#667eea">

<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif; background: #f5f5f5; color: #333; }
.header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 1rem; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
.header-content { max-width: 1000px; margin: 0 auto; display: flex; flex-direction: column; align-items: center; gap: 0.8rem; }
.header h1 { font-size: 1.3rem; font-weight: 600; text-align: center; }
.header-buttons { display: flex; gap: 0.8rem; justify-content: center; align-items: center; }
.btn { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 0.6rem; border-radius: 6px; cursor: pointer; font-size: 1.2rem; transition: all 0.2s; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; }
.btn:hover { background: rgba(255,255,255,0.3); }
.container { max-width: 1000px; margin: 0 auto; padding: 1rem; padding-bottom: 3rem; }
.menu { display: grid; gap: 0.5rem; }
.menu-item { background: white; padding: 1rem; border-radius: 8px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: all 0.2s; }
.menu-item:hover { box-shadow: 0 4px 12px rgba(0,0,0,0.15); transform: translateY(-2px); }
.menu-item-left { display: flex; align-items: center; gap: 0.8rem; }
.menu-item-id { font-weight: 600; font-size: 1.1rem; color: #667eea; }
.menu-item-sex { font-size: 0.85rem; color: #666; background: #f0f0f0; padding: 0.2rem 0.5rem; border-radius: 4px; }
.opt-badge { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 0.3rem 0.7rem; border-radius: 20px; font-size: 0.9rem; font-weight: 500; }
.detail { display: none; }
.detail.active { display: block; }
.qa-list { display: grid; gap: 0.8rem; }
.qa-item { background: white; padding: 1rem; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); border: 1px solid #ddd; cursor: pointer; transition: transform 0.1s, box-shadow 0.1s; }
.qa-item:hover { transform: scale(1.01); box-shadow: 0 4px 12px rgba(0,0,0,0.1); background-color: #fafafa; }
.qa-question { font-weight: 600; color: #667eea; margin-bottom: 0.5rem; font-size: 0.95rem; line-height: 1.4; }
.qa-answer { color: #333; font-size: 0.95rem; line-height: 1.5; padding-left: 1rem; border-left: 3px solid #667eea; }
.error-note { color: #d32f2f; font-style: italic; margin-top: 0.3rem; }

.qa-item.no-answer, .qa-item.multiple-answers, .qa-item.logic-error { background: #ffe6e6; border: 1px solid #d32f2f; }
.qa-item.no-answer .qa-answer, .qa-item.multiple-answers .qa-answer, .qa-item.logic-error .qa-answer { border-left-color: #d32f2f; color: #d32f2f; }

/* MODAL STYLES */
.modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center; padding: 1rem; }
.modal-content { background: white; border-radius: 12px; padding: 2rem; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3); color: #333; }
.modal-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 1rem; padding-bottom: 1rem; border-bottom: 2px solid #667eea; }
.modal-close { background: none; border: none; font-size: 2rem; color: #999; cursor: pointer; line-height: 1; margin-left: 1rem; }
.modal-title { font-weight: 600; font-size: 1.1rem; color: #1a1a2e; width: 100%; }

/* STILI OPZIONI NEL POPUP */
.option-wrapper { display: flex; flex-direction: column; border-bottom: 1px solid #eee; padding: 10px 0; }
.option-wrapper:last-child { border-bottom: none; }
.option-row { font-size: 1rem; color: #555; padding: 0 12px; margin-bottom: 4px; display: flex; justify-content: space-between; align-items: center; }
.option-row.selected { color: #155724; font-weight: 700; }
.check-mark { color: #28a745; margin-left: 10px; font-weight: bold; }

.stat-bar-container { width: 100%; height: 20px; position: relative; padding: 0 12px; display: flex; align-items: center; }
.stat-bar { height: 8px; border-radius: 4px; opacity: 0.6; transition: width 0.5s ease; }
.stat-text { font-size: 0.75rem; color: #888; margin-left: 10px; min-width: 40px; }

.text-answer-box { background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #eee; font-style: italic; }

/* Lista Giochi */
.games-list { max-height: 250px; overflow-y: auto; font-size: 0.9rem; padding-left: 1.2rem; color: #444; margin-top: 10px; }
.games-list li { margin-bottom: 4px; }

/* Loading Overlay */
#loadingOverlay {
    display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(255,255,255,0.9); z-index: 2000;
    justify-content: center; align-items: center; flex-direction: column;
}
.spinner { width: 50px; height: 50px; border: 5px solid #ccc; border-top-color: #667eea; border-radius: 50%; animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }
</style>
</head>
<body>

<div id="loadingOverlay">
    <div class="spinner"></div>
    <p style="margin-top: 20px; color: #667eea; font-weight: bold;">üîÑ Ricaricamento da GitHub...</p>
</div>

<div class="header">
    <div class="header-content">
        <h1 id="title">Questionari AVIS</h1>
        <div class="header-buttons">
            <button class="btn" id="prevBtn" style="display:none" onclick="navigate(-1)">‚Üê</button>
            <button class="btn" id="homeBtn" style="display:none" onclick="goBack()">üè†</button>
            <button class="btn" id="viewBtn" style="display:none" onclick="viewPDF()">üîç</button>
            <button class="btn" id="printBtn" style="display:none" onclick="printPDF()">üñ®Ô∏è</button>
            <button class="btn" id="nextBtn" style="display:none" onclick="navigate(1)">‚Üí</button>
        </div>
    </div>
</div>

<div class="container">
    <div id="menu" class="menu"></div>
    <div id="detail" class="detail"></div>
</div>

<div id="infoModal" class="modal-overlay" onclick="closeModal('infoModal')">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
            <h2 class="modal-title">üìä Legenda</h2>
            <button class="modal-close" onclick="closeModal('infoModal')">&times;</button>
        </div>
        <p>I campi evidenziati in rosso indicano una risposta mancante o un'incongruenza logica.</p>
        <p>Clicca su una domanda per vedere le statistiche di risposta.</p>
        <p>Usa üîç per visualizzare il PDF originale (Frame.pdf) e üñ®Ô∏è per scaricare il report generato.</p>
        <hr style="margin: 15px 0; border: 0; border-top: 1px solid #eee;">
        <p style="font-size: 0.9rem; color: #666;">üí° <strong>Tip:</strong> Trascina verso il basso (in cima) o verso l'alto (in fondo) per ricaricare l'app.</p>
    </div>
</div>

<div id="questionModal" class="modal-overlay" onclick="closeModal('questionModal')">
    <div class="modal-content" onclick="event.stopPropagation()">
        <div class="modal-header">
            <div id="qModalTitle" class="modal-title"></div>
            <button class="modal-close" onclick="closeModal('questionModal')">&times;</button>
        </div>
        <div id="qModalContent"></div>
    </div>
</div>

<script>
const allData = [{"id": "MA-ONOFRIO", "sex": "Maschio", "opt": "80% üòä", "answers": [{"q": "1. Hai mai sentito parlare di sistema trasfusionale?", "key_id": "Q01", "raw": "B", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "No", "a_html": "No"}, {"q": "2. Hai mai sentito parlare dei gruppi sanguigni?", "key_id": "Q02", "raw": "A", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "S√¨", "a_html": "S√¨"}, {"q": "3. Sai che gruppo sanguigno hai tu?", "key_id": "Q03", "raw": "B", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "No", "a_html": "No"}, {"q": "3b. Se hai risposto s√¨, sapresti dire quale?", "key_id": "Q03-T", "raw": "NO", "options": null, "is_text": true, "error": "logic-error", "a": "NO", "a_html": "<strong>NO</strong>"}, {"q": "4. Cosa pensi significhi 'donazione di sangue'?", "key_id": "Q04", "raw": "A", "options": {"A": "Dare sangue a chi ne ha bisogno", "B": "Dare sangue in cambio di denaro", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "Dare sangue a chi ne ha bisogno", "a_html": "Dare sangue a chi ne ha bisogno"}, {"q": "5. Cosa pensi significhi 'trasfusione di sangue'?", "key_id": "Q05", "raw": "C", "options": {"A": "Modificare il sangue di una persona", "B": "Trasferire sangue in una persona", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a"}, {"q": "6. Hai parlato di recente della donazione di sangue con qualcuno?", "key_id": "Q06", "raw": "B", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "No", "a_html": "No"}, {"q": "7. Conosci qualcuno che ha donato Sangue?", "key_id": "Q07", "raw": "C", "options": {"A": "S√¨, pi√π di una persona", "B": "S√¨, una sola persona", "C": "Nessuno"}, "is_text": false, "error": null, "a": "Nessuno", "a_html": "Nessuno"}, {"q": "8. Conosci qualcuno che ha donato Plasma?", "key_id": "Q08", "raw": "C", "options": {"A": "S√¨", "B": "No", "C": "Non so cos'√® il plasma"}, "is_text": false, "error": null, "a": "Non so cos'√® il plasma", "a_html": "Non so cos'√® il plasma"}, {"q": "9. Secondo te quanto √® importante donare sangue?", "key_id": "Q09", "raw": "A", "options": {"A": "√à molto importante", "B": "√à abbastanza importante", "C": "Non √® importante"}, "is_text": false, "error": null, "a": "√à molto importante", "a_html": "√à molto importante"}, {"q": "10. Che cosa pensi della donazione di sangue?", "key_id": "Q10", "raw": "A", "options": {"A": "√à una cosa bella", "B": "√à una cosa brutta", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "√à una cosa bella", "a_html": "√à una cosa bella"}, {"q": "11. Quando pensi alla donazione di sangue, come ti senti?", "key_id": "Q11", "raw": "A", "options": {"A": "Felice", "B": "Triste", "C": "Non lo so"}, "is_text": false, "error": null, "a": "Felice", "a_html": "Felice"}, {"q": "12. Quando pensi a qualcuno che dona, come ti senti?", "key_id": "Q12", "raw": "C", "options": {"A": "Felice", "B": "Triste", "C": "Non lo so"}, "is_text": false, "error": null, "a": "Non lo so", "a_html": "Non lo so"}, {"q": "13. Immaginando te da grande, cosa faresti?", "key_id": "Q13", "raw": "C", "options": {"A": "Vorrei donare il sangue", "B": "Non vorrei donare il sangue", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a"}, {"q": "14. Consiglieresti ad un adulto di donare sangue o plasma?", "key_id": "Q14", "raw": "C", "options": {"A": "S√¨", "B": "No", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a"}, {"q": "15. Quanto spesso giochi ai giochi da tavolo o di carte?", "key_id": "Q15", "raw": "D", "options": {"A": "Tutti i giorni", "B": "Almeno una volta a settimana", "C": "Almeno una volta al mese", "D": "Quasi mai", "E": "Mai"}, "is_text": false, "error": null, "a": "Quasi mai", "a_html": "Quasi mai"}, {"q": "16. Quanto spesso giochi su cellulare, tablet, computer o console?", "key_id": "Q16", "raw": "B", "options": {"A": "Tutti i giorni", "B": "Almeno una volta a settimana", "C": "Almeno una volta al mese", "D": "Quasi mai", "E": "Mai"}, "is_text": false, "error": null, "a": "Almeno una volta a settimana", "a_html": "Almeno una volta a settimana"}, {"q": "17. Giochi pi√π spesso a:", "key_id": "Q17", "raw": "A", "options": {"A": "Giochi in cui devi muoverti", "B": "Giochi in cui devi pensare"}, "is_text": false, "error": null, "a": "Giochi in cui devi muoverti", "a_html": "Giochi in cui devi muoverti"}, {"q": "18. Preferisci:", "key_id": "Q18", "raw": "A", "options": {"A": "Giochi in cui devi muoverti", "B": "Giochi in cui devi pensare"}, "is_text": false, "error": null, "a": "Giochi in cui devi muoverti", "a_html": "Giochi in cui devi muoverti"}, {"q": "19. Preferisci giochi in cui:", "key_id": "Q19", "raw": "AB", "options": {"A": "Risolvere enigmi", "B": "Scoprire cose", "C": "Aiutare gli altri", "D": "Collezionare premi/obiettivi", "E": "Sconfiggere gli altri"}, "is_text": false, "error": null, "a": "Risolvere enigmi, Scoprire cose", "a_html": "Risolvere enigmi, Scoprire cose"}, {"q": "20. Scrivi il nome dei 3 giochi a cui giochi pi√π spesso", "key_id": "Q20", "a": "JUST DANCE, MARIO KART, ANIMAL CROSSING", "a_html": "<strong>JUST DANCE, MARIO KART, ANIMAL CROSSING</strong>", "raw": "JUST DANCE, MARIO KART, ANIMAL CROSSING", "options": null, "is_text": true, "error": null}, {"q": "21. Cosa nel sangue √® giallo, liquido e ricco di nutrienti?", "key_id": "Q21", "raw": "C", "options": {"A": "Piastrina", "B": "Globulo rosso", "C": "Globulo bianco", "D": "Plasma"}, "is_text": false, "error": null, "a": "Globulo bianco", "a_html": "Globulo bianco"}, {"q": "22. Quali sono i gruppi sanguigni?", "key_id": "Q22", "raw": "C", "options": {"A": "A, B, AB, 0", "B": "A, B, C, D", "C": "Plasma, sangue e globuli rossi", "D": "X, Y, XY, XX"}, "is_text": false, "error": null, "a": "Plasma, sangue e globuli rossi", "a_html": "Plasma, sangue e globuli rossi"}, {"q": "23. Chi tra queste persone pu√≤ donare sangue?", "key_id": "Q23", "raw": "D", "options": {"A": "Luisa di 10 anni", "B": "Cristiano di 75 anni", "C": "Giovanna di 45 anni", "D": "Simone di 16 anni"}, "is_text": false, "error": null, "a": "Simone di 16 anni", "a_html": "Simone di 16 anni"}, {"q": "24. Quale gruppo sanguigno pu√≤ donare sangue a pi√π gruppi?", "key_id": "Q24", "raw": "A", "options": {"A": "AB", "B": "0 (Zero)", "C": "C", "D": "XY"}, "is_text": false, "error": null, "a": "AB", "a_html": "AB"}, {"q": "25. Cosa √® AVIS?", "key_id": "Q25", "raw": "B", "options": {"A": "Assoc. Vaccinati Italiani Sanitari", "B": "Assistenza Volontari Sangue", "C": "Assoc. Volontari Italiani Sangue", "D": "Assemblea Veri Ispiratori"}, "is_text": false, "error": null, "a": "Assistenza Volontari Sangue", "a_html": "Assistenza Volontari Sangue"}, {"q": "26. Chi sono i donatori di sangue?", "key_id": "Q26", "raw": "C", "options": {"A": "Scelte dagli ospedali periodicamente", "B": "Medici e infermieri curanti", "C": "Persone comuni volontarie", "D": "Persone comuni pagate"}, "is_text": false, "error": null, "a": "Persone comuni volontarie", "a_html": "Persone comuni volontarie"}, {"q": "27. Quando √® utilizzato il sangue donato?", "key_id": "Q27", "raw": "D", "options": {"A": "Solo operazioni molto difficili", "B": "Solo malattie del sangue", "C": "Solo emergenze al pronto soccorso", "D": "Emergenze, operazioni e terapie"}, "is_text": false, "error": null, "a": "Emergenze, operazioni e terapie", "a_html": "Emergenze, operazioni e terapie"}, {"q": "28. In questi ultimi giorni, quanto sei felice?", "key_id": "Q28", "raw": "D", "options": {"A": "‚òπÔ∏è Per niente felice", "B": "üòê Poco felice", "C": "üôÇ Abbastanza felice", "D": "üòÑ Molto felice"}, "is_text": false, "error": null, "a": "üòÑ Molto felice", "a_html": "üòÑ Molto felice"}, {"q": "29. Quanto sei soddisfatta/o della tua vita a scuola?", "key_id": "Q29", "raw": "D", "options": {"A": "‚òπÔ∏è Per niente soddisfatta/o", "B": "üòê Poco soddisfatta/o", "C": "üôÇ Abbastanza soddisfatta/o", "D": "üòÑ Molto soddisfatta/o"}, "is_text": false, "error": null, "a": "üòÑ Molto soddisfatta/o", "a_html": "üòÑ Molto soddisfatta/o"}, {"q": "30. Quanto sei contenta/o della tua vita a casa?", "key_id": "Q30", "raw": "D", "options": {"A": "‚òπÔ∏è Per niente contenta/o", "B": "üòê Poco contenta/o", "C": "üôÇ Abbastanza contenta/o", "D": "üòÑ Molto contenta/o"}, "is_text": false, "error": null, "a": "üòÑ Molto contenta/o", "a_html": "üòÑ Molto contenta/o"}, {"q": "31. Biglietti regalo (0-10)", "key_id": "Q31", "raw": "10", "options": null, "is_text": true, "error": null, "a": "10", "a_html": "<strong>10</strong>"}], "page_num": 2, "pdf_data": "JVBERi0xLjQKJZOMi54gUmVwb3J0TGFiIEdlbmVyYXRlZCBQREYgZG9jdW1lbnQgaHR0cDovL3d3dy5yZXBvcnRsYWIuY29tCjEgMCBvYmoKPDwKL0YxIDIgMCBSIC9GMiAzIDAgUiAvRjMgNCAwIFIgL0Y0IDUgMCBSCj4+CmVuZG9iagoyIDAgb2JqCjw8Ci9CYXNlRm9udCAvSGVsdmV0aWNhIC9FbmNvZGluZyAvV2luQW5zaUVuY29kaW5nIC9OYW1lIC9GMSAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjMgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtQm9sZCAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjIgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago0IDAgb2JqCjw8Ci9CYXNlRm9udCAvWmFwZkRpbmdiYXRzIC9OYW1lIC9GMyAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjUgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtT2JsaXF1ZSAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjQgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago2IDAgb2JqCjw8Ci9Db250ZW50cyAxMCAwIFIgL01lZGlhQm94IFsgMCAwIDU5NS4yNzU2IDg0MS44ODk4IF0gL1BhcmVudCA5IDAgUiAvUmVzb3VyY2VzIDw8Ci9Gb250IDEgMCBSIC9Qcm9jU2V0IFsgL1BERiAvVGV4dCAvSW1hZ2VCIC9JbWFnZUMgL0ltYWdlSSBdCj4+IC9Sb3RhdGUgMCAvVHJhbnMgPDwKCj4+IAogIC9UeXBlIC9QYWdlCj4+CmVuZG9iago3IDAgb2JqCjw8Ci9QYWdlTW9kZSAvVXNlTm9uZSAvUGFnZXMgOSAwIFIgL1R5cGUgL0NhdGFsb2cKPj4KZW5kb2JqCjggMCBvYmoKPDwKL0F1dGhvciAoXChhbm9ueW1vdXNcKSkgL0NyZWF0aW9uRGF0ZSAoRDoyMDI2MDIwNjAwMDgzNiswMScwMCcpIC9DcmVhdG9yIChcKHVuc3BlY2lmaWVkXCkpIC9LZXl3b3JkcyAoKSAvTW9kRGF0ZSAoRDoyMDI2MDIwNjAwMDgzNiswMScwMCcpIC9Qcm9kdWNlciAoUmVwb3J0TGFiIFBERiBMaWJyYXJ5IC0gd3d3LnJlcG9ydGxhYi5jb20pIAogIC9TdWJqZWN0IChcKHVuc3BlY2lmaWVkXCkpIC9UaXRsZSAoXChhbm9ueW1vdXNcKSkgL1RyYXBwZWQgL0ZhbHNlCj4+CmVuZG9iago5IDAgb2JqCjw8Ci9Db3VudCAxIC9LaWRzIFsgNiAwIFIgXSAvVHlwZSAvUGFnZXMKPj4KZW5kb2JqCjEwIDAgb2JqCjw8Ci9GaWx0ZXIgWyAvQVNDSUk4NURlY29kZSAvRmxhdGVEZWNvZGUgXSAvTGVuZ3RoIDI2MjUKPj4Kc3RyZWFtCkdhdWBWPj5sS10mcTkiRm9MbT1QLScqOFFdOjUtYzE5aGpfISZpOUknLy44L0xjTWpaR3FWcFhJc2xXVFYtVyFiMShMVnMnTSpjPGwxcW9ncXM0JkcraTclP14xU2ItZ0dRV2g6T3Q5J2haPU5cXyJwITdbbSdZOUtNUkZxImYyTmVQZj8+NmN0bl5scjRiNFJLVmc0JlI3Yj4qV0Jfci07TzEzb0VrKSksI2pwUnVePWxfJjVlNDNSTTp1K1FocFwsQC8wUzdIVGNnJiE4QVhobS0yblItb008TlhwVFhZUyFHZl5VQj9TbUNrODNTPzpHOkw9ZWomTWVZVCQ2a0NFbyM/czJtWismbU06JllDKF9wZ1sqNTghKjsiOyZZSF9ZZ0dYIUArIUhLVEs2bXQ7L2ZETlkrTHJqYiZ0VWtZaTo9YnQsbmczJSNaV205Mj8nYi8naj5UIW5HJHU2KlgtLCEmLzAzZTNfaTZyVScpKVEsRytKWUQ7XD9iXCIwS0toO0JvT15ScVtlTVFuIV5pJ25YQGVZKWZCL3AxZV4/MDUuUmhxUU8rTjtAM2wmL0U1QkwwLiJrPWZhO11DZjNDXS9mZy42JThrJiNMZzBxTXBXJk42Y2U6WEA/Uy9FdGQkcS5UJEI4MjBLPjAwWVFeOFclN15valRDVVsuJHMqPFBbQDFPWS9QWF1LUCtjUiU8JSpTRjUrPyVIbV90MlNsNFY4PlYnPj9zPjZWWk8rLEVnISVpNC5ePzgnSGIyUjQqVjg6LChXZHJhOTc5UF5SciFCR3VYa1MzO0xMRElDcmNnRmBDcj0uQSZfLmNaL2k0XFFHJCtqYVAkRUBGIzlOImZcVSZwIilWJnIlLDJsV2FHKjNJcW9zU19gQjBcRmcsRiU8cVQmWTRvXzZXUlI1P3Era1MvOz9ANDRQSHQ5QC1ySzJMJjpncXJpUzdrcFIhKV1DUipyK11VQk1qVEQvQVVXQFk0RlNcYkBUciQ5SmVuZUByXkUvQjVcOzYscCRhbmFRcUtgJDtLPkkrST1HQEVZLExsbVRfUEBAZFQlPjdgY24+N0s/IkMySk9BJm9oXWs0aTQ2PVhOazFYNms+UjtWS2kqXyIpT0FSXTxPPWBCKWNEQmZXWzJHWVsxPGYwQXRRazInK1t1QixLVCQtJClLVlJmbDxIS1M+NThIbmw9NV1EVTVeI2pnbnRQX1EubVBzckhpWi05VSZsXlJhMXBAM1pyTGFNQSYhSmxnX2lcbk0mIS1tMy5ELENiRWU/cilSMz0nYmtCOWtobC1TNVo3Iz5QRDRGZ1hgdWZbY2ghWUEwLT5MbS9NLGlCTD9BNzF0Zk9kXmMqJm0lM11rQS4xK1AjLWc7cTxTXzZrcDM9L1RIVDBsREVFUDxfSTZhKTE4WXI0SzpyWEJIcEYvKmgtbUJqISs0ZihMK3NoaUZwI0lkMnJgSkJtZTM2dSkuRFokPyY0TmUsY0pbKWI/WF9dTV5fRiJxSWVeRHI4WC5CTlFvZSlfVTZJLDVGJitDNF8+OC5NNmcpTmFLbidbUTAiNXVQQmlmVEhSKCUhYypjXipGVmVyIjArbiZKUElrOW1laDNwSXNFSWVjSyE0LmY1L2c7Sy0mcW5LaFZ1bkRrW1okOTxwVzZWLUswRzIiVClCZT1oUCZoLkhMVT1VSEtGL2UsOWZscWo3dDYjI28tO0tTa2dlZDpSTGdCcnJfaWckL2NVKjYoKCpMUnJDT01eXzA0SmBgN2dTXVskdExIKSpVQGRRbTJgXFksOUQ4Tjc2dHFDLWIiclBKaElLQ0NmcihQMm9CSzJAJ1AhdCZTLSpaXlU7UFUpLjQ3ZS5FczZvI1g1akFTaDNabjFtaTwtaFhARF91OEtyNSMzaVQoSDdTN1UuJUosRUNeJXMhIy5TQmdTVltaZEYrPDk+WUI/TlYqNS4lVVZeY0xuaz9fXz1cbGUjPDJCZGsmMVRqJXAnLDcjLTA+KW11KWJvNU5vYVZtalE2b1FIN2QqInJUaiRuaDExT01aamQjKj05a0s4WVwqSmlNVV5wN0o8JFtNXylKcE5OKT0jTWtlcW0pJzRvOEojVFtvXEImM2xsJFUmc0FPbU01KDUyXl9MVFMxIm9pTXVSUGAjIj4zXVFuKzZyWiIuZnBCc3I9UEY9XGh0RS1Ua05NOy1uY0lkYjAoUjtxS1BmVy4lPyxIKihgQC1vcXFdMC9wOSdBWUA3U004YmplKSdJWTxSKkMkXTVFaEs+XkZRLGlEa04kdEpvWl5oV244QmUoaytjWmQ7YCNqX3FDczxdVWtycWw9N3VuLSdFPTVdXEhrR0AiLVZPXEhEY3VXSTQ6WmY8LSNZaSoxVmtLdTguUyRfYEI5ImFJYVBBPCg2Nj9VUyw+MF8kcjRmPFVIQytMOm5JTUYtcjVsSVVLXklkIjZyb0Rdb1ZgdWw0IVJgXyoiQV1GX1MoMStpSEQlUS5fQzYhTlc8WTJIRjlQN2VTXDNUOkQ8Pl4pSEJvUGNxOz1pcT06Q00uSSRtL0IsKForV24+ITk+Jk4jTVkjRlpdTF5SXiYsbEZmXlQwNmlab2dRdVt0KGdIamxsc0hdIkQ5JEAhUjNJW2VwUzAvaF44K2UrNCk2OjxhdTI6JWVaXT9XXFdbJllSOik0bkViUzY1dFFwRVA2bj5JLXFIaCU2NjZsYjhfSiRxUTtSITpNPnJxJiFhQWM8TjtlLW1aRVo8KWRSIz1hWUFpKzJWQVY+TVFwU1IwJE0sQ15JOlU2cjxYcCslRy5oQkk3aVMpRVNxZExsRi1BISRvQC1VUFBwIm0ob0BWMEAuITFzSFJYTkA9VXMzIUMkZ28sW19MZ1pxOy1zJ2g/Qi5bPGk0Wy45aTIpKldkTVVTN2cjN0lMWGEsRF9uNCxXbkUsSG1rW1Y0QUhHaGNRJG4nIj0uS0xqImpdZGYtQXMna1VvKVUta1tbMlNPbCprVSNucHJUaWZYNVBPNDEyKWwpTGZgK11CWEtKRy1bVG0sUCkxS1BQcCI1KGZOZihmaUBpNm9QMD8yU2NAYkg1aXE9bFkwYy1waCxoVGtbS0g6Z1lnOShsTlY1Xmg/UyE4JVQzWz9LU0xNZTdZPyNVISxPWk0laT1VVSVQMVI8JERgNCFYcSNZPHQzX2tNY2ZQYGohXkBfZk05XUZaNzVHN2UqQS5WTTpUdWU1Ok1wQFFJcSk5JUs1V18tN2BTJzIjLjNMZzojVWsxbjNTajYhSDFDIlFiLVU7PFVdJDpjKEpDWVZcKG9RK1JpQmk1bEU4VFNsQ0llKG9idFEzaURxSnBsZiZjY0lXQDA5anUlXGheYlsmO0FlRGcqcVotalMqXiw8RkwxTSxqVy5QLGxGUicqWzVrL1c/SXJgXEFvbSZCdWFhUUphTjhwI3NlZDQhOEJBWzErZDVYUiQqQ207SUZTMz5mPGFWU0k0aD4wc2RBLUJta1lHZVEmO0x+PmVuZHN0cmVhbQplbmRvYmoKeHJlZgowIDExCjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDA3MyAwMDAwMCBuIAowMDAwMDAwMTM0IDAwMDAwIG4gCjAwMDAwMDAyNDEgMDAwMDAgbiAKMDAwMDAwMDM1MyAwMDAwMCBuIAowMDAwMDAwNDM2IDAwMDAwIG4gCjAwMDAwMDA1NTEgMDAwMDAgbiAKMDAwMDAwMDc1NSAwMDAwMCBuIAowMDAwMDAwODIzIDAwMDAwIG4gCjAwMDAwMDExMDYgMDAwMDAgbiAKMDAwMDAwMTE2NSAwMDAwMCBuIAp0cmFpbGVyCjw8Ci9JRCAKWzxiMzU4YjJkMTVhYTY2YWI5ODc1NTlkNzA5ZDZhNDRjZT48YjM1OGIyZDE1YWE2NmFiOTg3NTU5ZDcwOWQ2YTQ0Y2U+XQolIFJlcG9ydExhYiBnZW5lcmF0ZWQgUERGIGRvY3VtZW50IC0tIGRpZ2VzdCAoaHR0cDovL3d3dy5yZXBvcnRsYWIuY29tKQoKL0luZm8gOCAwIFIKL1Jvb3QgNyAwIFIKL1NpemUgMTEKPj4Kc3RhcnR4cmVmCjM4ODIKJSVFT0YK"}, {"id": "MA-TERESA", "sex": "Femmina", "opt": "72% üòä", "answers": [{"q": "1. Hai mai sentito parlare di sistema trasfusionale?", "key_id": "Q01", "raw": "B", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "No", "a_html": "No"}, {"q": "2. Hai mai sentito parlare dei gruppi sanguigni?", "key_id": "Q02", "raw": "B", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "No", "a_html": "No"}, {"q": "3. Sai che gruppo sanguigno hai tu?", "key_id": "Q03", "raw": "B", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "No", "a_html": "No"}, {"q": "3b. Se hai risposto s√¨, sapresti dire quale?", "key_id": "Q03-T", "raw": "", "options": null, "is_text": true, "error": null, "a": "(nessuna risposta)", "a_html": "<span style=\"color:#999; font-style:italic;\">(nessuna risposta)</span>"}, {"q": "4. Cosa pensi significhi 'donazione di sangue'?", "key_id": "Q04", "raw": "A", "options": {"A": "Dare sangue a chi ne ha bisogno", "B": "Dare sangue in cambio di denaro", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "Dare sangue a chi ne ha bisogno", "a_html": "Dare sangue a chi ne ha bisogno"}, {"q": "5. Cosa pensi significhi 'trasfusione di sangue'?", "key_id": "Q05", "raw": "B", "options": {"A": "Modificare il sangue di una persona", "B": "Trasferire sangue in una persona", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "Trasferire sangue in una persona", "a_html": "Trasferire sangue in una persona"}, {"q": "6. Hai parlato di recente della donazione di sangue con qualcuno?", "key_id": "Q06", "raw": "A", "options": {"A": "S√¨", "B": "No"}, "is_text": false, "error": null, "a": "S√¨", "a_html": "S√¨"}, {"q": "7. Conosci qualcuno che ha donato Sangue?", "key_id": "Q07", "raw": "C", "options": {"A": "S√¨, pi√π di una persona", "B": "S√¨, una sola persona", "C": "Nessuno"}, "is_text": false, "error": null, "a": "Nessuno", "a_html": "Nessuno"}, {"q": "8. Conosci qualcuno che ha donato Plasma?", "key_id": "Q08", "raw": "C", "options": {"A": "S√¨", "B": "No", "C": "Non so cos'√® il plasma"}, "is_text": false, "error": null, "a": "Non so cos'√® il plasma", "a_html": "Non so cos'√® il plasma"}, {"q": "9. Secondo te quanto √® importante donare sangue?", "key_id": "Q09", "raw": "A", "options": {"A": "√à molto importante", "B": "√à abbastanza importante", "C": "Non √® importante"}, "is_text": false, "error": null, "a": "√à molto importante", "a_html": "√à molto importante"}, {"q": "10. Che cosa pensi della donazione di sangue?", "key_id": "Q10", "raw": "B", "options": {"A": "√à una cosa bella", "B": "√à una cosa brutta", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "√à una cosa brutta", "a_html": "√à una cosa brutta"}, {"q": "11. Quando pensi alla donazione di sangue, come ti senti?", "key_id": "Q11", "raw": "B", "options": {"A": "Felice", "B": "Triste", "C": "Non lo so"}, "is_text": false, "error": null, "a": "Triste", "a_html": "Triste"}, {"q": "12. Quando pensi a qualcuno che dona, come ti senti?", "key_id": "Q12", "raw": "A", "options": {"A": "Felice", "B": "Triste", "C": "Non lo so"}, "is_text": false, "error": null, "a": "Felice", "a_html": "Felice"}, {"q": "13. Immaginando te da grande, cosa faresti?", "key_id": "Q13", "raw": "C", "options": {"A": "Vorrei donare il sangue", "B": "Non vorrei donare il sangue", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "Non ne sono sicuro/a", "a_html": "Non ne sono sicuro/a"}, {"q": "14. Consiglieresti ad un adulto di donare sangue o plasma?", "key_id": "Q14", "raw": "A", "options": {"A": "S√¨", "B": "No", "C": "Non ne sono sicuro/a"}, "is_text": false, "error": null, "a": "S√¨", "a_html": "S√¨"}, {"q": "15. Quanto spesso giochi ai giochi da tavolo o di carte?", "key_id": "Q15", "raw": "C", "options": {"A": "Tutti i giorni", "B": "Almeno una volta a settimana", "C": "Almeno una volta al mese", "D": "Quasi mai", "E": "Mai"}, "is_text": false, "error": null, "a": "Almeno una volta al mese", "a_html": "Almeno una volta al mese"}, {"q": "16. Quanto spesso giochi su cellulare, tablet, computer o console?", "key_id": "Q16", "raw": "B", "options": {"A": "Tutti i giorni", "B": "Almeno una volta a settimana", "C": "Almeno una volta al mese", "D": "Quasi mai", "E": "Mai"}, "is_text": false, "error": null, "a": "Almeno una volta a settimana", "a_html": "Almeno una volta a settimana"}, {"q": "17. Giochi pi√π spesso a:", "key_id": "Q17", "raw": "A", "options": {"A": "Giochi in cui devi muoverti", "B": "Giochi in cui devi pensare"}, "is_text": false, "error": null, "a": "Giochi in cui devi muoverti", "a_html": "Giochi in cui devi muoverti"}, {"q": "18. Preferisci:", "key_id": "Q18", "raw": "B", "options": {"A": "Giochi in cui devi muoverti", "B": "Giochi in cui devi pensare"}, "is_text": false, "error": null, "a": "Giochi in cui devi pensare", "a_html": "Giochi in cui devi pensare"}, {"q": "19. Preferisci giochi in cui:", "key_id": "Q19", "raw": "B", "options": {"A": "Risolvere enigmi", "B": "Scoprire cose", "C": "Aiutare gli altri", "D": "Collezionare premi/obiettivi", "E": "Sconfiggere gli altri"}, "is_text": false, "error": null, "a": "Scoprire cose", "a_html": "Scoprire cose"}, {"q": "20. Scrivi il nome dei 3 giochi a cui giochi pi√π spesso", "key_id": "Q20", "a": "UNO, MONOPOLY, ROBLOX", "a_html": "<strong>UNO, MONOPOLY, ROBLOX</strong>", "raw": "UNO, MONOPOLY, ROBLOX", "options": null, "is_text": true, "error": null}, {"q": "21. Cosa nel sangue √® giallo, liquido e ricco di nutrienti?", "key_id": "Q21", "raw": "C", "options": {"A": "Piastrina", "B": "Globulo rosso", "C": "Globulo bianco", "D": "Plasma"}, "is_text": false, "error": null, "a": "Globulo bianco", "a_html": "Globulo bianco"}, {"q": "22. Quali sono i gruppi sanguigni?", "key_id": "Q22", "raw": "B", "options": {"A": "A, B, AB, 0", "B": "A, B, C, D", "C": "Plasma, sangue e globuli rossi", "D": "X, Y, XY, XX"}, "is_text": false, "error": null, "a": "A, B, C, D", "a_html": "A, B, C, D"}, {"q": "23. Chi tra queste persone pu√≤ donare sangue?", "key_id": "Q23", "raw": "D", "options": {"A": "Luisa di 10 anni", "B": "Cristiano di 75 anni", "C": "Giovanna di 45 anni", "D": "Simone di 16 anni"}, "is_text": false, "error": null, "a": "Simone di 16 anni", "a_html": "Simone di 16 anni"}, {"q": "24. Quale gruppo sanguigno pu√≤ donare sangue a pi√π gruppi?", "key_id": "Q24", "raw": "C", "options": {"A": "AB", "B": "0 (Zero)", "C": "C", "D": "XY"}, "is_text": false, "error": null, "a": "C", "a_html": "C"}, {"q": "25. Cosa √® AVIS?", "key_id": "Q25", "raw": "A", "options": {"A": "Assoc. Vaccinati Italiani Sanitari", "B": "Assistenza Volontari Sangue", "C": "Assoc. Volontari Italiani Sangue", "D": "Assemblea Veri Ispiratori"}, "is_text": false, "error": null, "a": "Assoc. Vaccinati Italiani Sanitari", "a_html": "Assoc. Vaccinati Italiani Sanitari"}, {"q": "26. Chi sono i donatori di sangue?", "key_id": "Q26", "raw": "C", "options": {"A": "Scelte dagli ospedali periodicamente", "B": "Medici e infermieri curanti", "C": "Persone comuni volontarie", "D": "Persone comuni pagate"}, "is_text": false, "error": null, "a": "Persone comuni volontarie", "a_html": "Persone comuni volontarie"}, {"q": "27. Quando √® utilizzato il sangue donato?", "key_id": "Q27", "raw": "C", "options": {"A": "Solo operazioni molto difficili", "B": "Solo malattie del sangue", "C": "Solo emergenze al pronto soccorso", "D": "Emergenze, operazioni e terapie"}, "is_text": false, "error": null, "a": "Solo emergenze al pronto soccorso", "a_html": "Solo emergenze al pronto soccorso"}, {"q": "28. In questi ultimi giorni, quanto sei felice?", "key_id": "Q28", "raw": "0", "options": {"A": "‚òπÔ∏è Per niente felice", "B": "üòê Poco felice", "C": "üôÇ Abbastanza felice", "D": "üòÑ Molto felice"}, "is_text": false, "error": "no-answer", "a": "(nessuna risposta)", "a_html": "(nessuna risposta)"}, {"q": "29. Quanto sei soddisfatta/o della tua vita a scuola?", "key_id": "Q29", "raw": "D", "options": {"A": "‚òπÔ∏è Per niente soddisfatta/o", "B": "üòê Poco soddisfatta/o", "C": "üôÇ Abbastanza soddisfatta/o", "D": "üòÑ Molto soddisfatta/o"}, "is_text": false, "error": null, "a": "üòÑ Molto soddisfatta/o", "a_html": "üòÑ Molto soddisfatta/o"}, {"q": "30. Quanto sei contenta/o della tua vita a casa?", "key_id": "Q30", "raw": "D", "options": {"A": "‚òπÔ∏è Per niente contenta/o", "B": "üòê Poco contenta/o", "C": "üôÇ Abbastanza contenta/o", "D": "üòÑ Molto contenta/o"}, "is_text": false, "error": null, "a": "üòÑ Molto contenta/o", "a_html": "üòÑ Molto contenta/o"}, {"q": "31. Biglietti regalo (0-10)", "key_id": "Q31", "raw": "10", "options": null, "is_text": true, "error": null, "a": "10", "a_html": "<strong>10</strong>"}], "page_num": 1, "pdf_data": "JVBERi0xLjQKJZOMi54gUmVwb3J0TGFiIEdlbmVyYXRlZCBQREYgZG9jdW1lbnQgaHR0cDovL3d3dy5yZXBvcnRsYWIuY29tCjEgMCBvYmoKPDwKL0YxIDIgMCBSIC9GMiAzIDAgUiAvRjMgNCAwIFIgL0Y0IDUgMCBSCj4+CmVuZG9iagoyIDAgb2JqCjw8Ci9CYXNlRm9udCAvSGVsdmV0aWNhIC9FbmNvZGluZyAvV2luQW5zaUVuY29kaW5nIC9OYW1lIC9GMSAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjMgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtQm9sZCAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjIgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago0IDAgb2JqCjw8Ci9CYXNlRm9udCAvWmFwZkRpbmdiYXRzIC9OYW1lIC9GMyAvU3VidHlwZSAvVHlwZTEgL1R5cGUgL0ZvbnQKPj4KZW5kb2JqCjUgMCBvYmoKPDwKL0Jhc2VGb250IC9IZWx2ZXRpY2EtT2JsaXF1ZSAvRW5jb2RpbmcgL1dpbkFuc2lFbmNvZGluZyAvTmFtZSAvRjQgL1N1YnR5cGUgL1R5cGUxIC9UeXBlIC9Gb250Cj4+CmVuZG9iago2IDAgb2JqCjw8Ci9Db250ZW50cyAxMCAwIFIgL01lZGlhQm94IFsgMCAwIDU5NS4yNzU2IDg0MS44ODk4IF0gL1BhcmVudCA5IDAgUiAvUmVzb3VyY2VzIDw8Ci9Gb250IDEgMCBSIC9Qcm9jU2V0IFsgL1BERiAvVGV4dCAvSW1hZ2VCIC9JbWFnZUMgL0ltYWdlSSBdCj4+IC9Sb3RhdGUgMCAvVHJhbnMgPDwKCj4+IAogIC9UeXBlIC9QYWdlCj4+CmVuZG9iago3IDAgb2JqCjw8Ci9QYWdlTW9kZSAvVXNlTm9uZSAvUGFnZXMgOSAwIFIgL1R5cGUgL0NhdGFsb2cKPj4KZW5kb2JqCjggMCBvYmoKPDwKL0F1dGhvciAoXChhbm9ueW1vdXNcKSkgL0NyZWF0aW9uRGF0ZSAoRDoyMDI2MDIwNjAwMDgzNiswMScwMCcpIC9DcmVhdG9yIChcKHVuc3BlY2lmaWVkXCkpIC9LZXl3b3JkcyAoKSAvTW9kRGF0ZSAoRDoyMDI2MDIwNjAwMDgzNiswMScwMCcpIC9Qcm9kdWNlciAoUmVwb3J0TGFiIFBERiBMaWJyYXJ5IC0gd3d3LnJlcG9ydGxhYi5jb20pIAogIC9TdWJqZWN0IChcKHVuc3BlY2lmaWVkXCkpIC9UaXRsZSAoXChhbm9ueW1vdXNcKSkgL1RyYXBwZWQgL0ZhbHNlCj4+CmVuZG9iago5IDAgb2JqCjw8Ci9Db3VudCAxIC9LaWRzIFsgNiAwIFIgXSAvVHlwZSAvUGFnZXMKPj4KZW5kb2JqCjEwIDAgb2JqCjw8Ci9GaWx0ZXIgWyAvQVNDSUk4NURlY29kZSAvRmxhdGVEZWNvZGUgXSAvTGVuZ3RoIDI2MjUKPj4Kc3RyZWFtCkdhdUhOPkJBT1cnN0tWWWZVJE85RnFmVj5QM2JpXkVLYmU3LF1PSHJTVFtJVTBNVGFTbj1vRThjSypUJCFEOTBMYXQ9PFpaLGAvSGJKPC0oQGVdNDE7MkZfKl0naWMubjliRGM/O2RGKTxuQlM/Jls2UWAwMzBIbTpAS1xFV0x1J0tQMSFIaChuL11ATCZWcjpQMGQxKStCKGo2Ly86XUU8NkEpRzliLGM+VCY9cWlNNkQqJzFTRU8qL3JBO2FOa19KUjZXY1tiOmRSSDczS1xwUjkyIzExSWNtPXVXdWthQmY5K1RZIVQnRDI/K3AlLkBYNypCWk1KUk1LMDw8JD81ZXNlaFx1cThQRi1FO1lqcHUkXUlaZFIhUzApZiZZP1lYZ0dYIUBULS5iR0szSzkrL2ZDQzkocUQiWiZ0VWtZaTheak84Z089X0xmP0JDMj8nYi8tKkg1a2k5b1ZIM3NzLSUrPT9GXEVoJjpsNmpZLCw3UWZlOzQyP1Y4RGBebSFcaFEoNHJWaCpMQ1c5aC5LYTI9Nj0rZnFRXSUhOm1GST8zOUlkOUJEZC05VEVKdUNaKzB1UVpzYV5UdD9AVW5DYEY2T05HQ2lDUmY2MCckRFg/V05hcmlaY3Fwc25CXCMtSFNEVlUtLzo9ODQ7cEcnVSdcQ05PcFpcK1UocnJwdFxoYSI8Tzc6YD9VMEtldSw4ZDRPQmdLJU1iUSRmQkpVcWRKOE5SSUU/YGtcOkk+U3JiM20iQGdrcjd1VzVHL1B1UkpTRFleUHBrLzg8SUkjb0w3YWo9ImlwNl1hRXMlby9oZXFzW10lWmRnO10tW2FtOkQwQnBoamI4TUQscClcXjRAYF9zRSs8L2NhVXFeXzJkVERYbWhdSDo1MnIpdU4oVEhOOi1IQz1CP2A/MnVLJTBULlZGKW8uJTxLZjAvOnBfIjFhKkw7XCFbcm1XIWdvZTElJFVmPHFmWWlRNSJHP1NNbiE/Kk08WmRiWW9oQWkjNmZaYXFbVCltJDQqSidzb2FhNSVFMidROmMzQWI0aU4pSCUhVDRhc2NLZU5LMlFwO1JZOydObFMqXC8xUDpLPlg/U0d0I007LztgcmtubmZSNCpFZDMoMGtKQFsjTk0yLyczcDxBbWI1ZF4xbDw1VGFKUWlDa1A9R2xoYWM4WCJnXW46XEkrJzMiVCU+JGhPZG9QcCtNbkFXTmdPWi1uQ0xvSjJITixARlkoYi5gIzpfTS8kU11yI2FkUlFGSmYvXEpAVVc2QSVRJCY/LDFEN1JdakklO3E9Q2Q9Vl9pYFtTPV5DRGwzNDdFaGxgOGFXOS1ScE06RGdyPzk6SW4oRyJkdUU7YF42aU9TVFYzTypvcWFbaiY4aVU4bHRsXmBIQlROLEpuOlRQS2knSGxua2k2ckdJSk89S1Y+SmskIlg2NGpoInE2N2tCJy5GTkhiOiE9SHAlcShiVj1xX2Q4ZFRbLUpJJFcsL1F1Jl06R0JGKzBFbDlgKkJuKCsmdUJWLD9JJzlXWWw+KkpsVmt1WjBTTmNeY29KTzUrbEw3aGJBSCdXZypJaXEiUlwoTUxFRiVDPGgtJ1JXO1cxRk8oRFVpPWQpOTwtPytRYT9vR0k+Nzc7ZiJLITlaPktdKWRKQihFMjxoamElXmN0PilMXSx1XyM0N21DJ0ZnYlI2SUZpYUwhNnVEbkVCNztPXnNcSEQmSSVEJS1tZT9gX11DSkghNTYpT3EjdDUoazBXSzY/azVjMzckPHItRHNJYC83PjEjKF9lMmI7Vy1wRTtvSi5hIms8WlpaYjNoVEc9OTVLOl4mYEAiTG5ITG8vKz47STldZ3NnOkolO1VDbEZ1YDczbidfKGRJKmI/Qy5NRlFxSGhxcmZyNDRLMFFqX2EqVzk7Pm1LXXVHL1AhRzMhZS1GJ2MvTUNkWCg5IToiRDhyMVFQZC5kdEM3QEJCL19DUUEhWlwvLEIuaycwX0RbJzFpa3VKdWNaNiYkPzVZWWhwLUErIXFLbyQ/SWVKbXUpYnArNE9TcEc2REd1OTRaWSIhI1wzc25mQE5oaERySGtDajFETTo9Ok8iX1hGSEQxNjgiJkNscV1LWVZFUVFIRW07IjRpOUEvbC1GS0xLNidKWVMnSXIsO01NaCxBTzVQWj1dKz0rKE1ybjk2VFU0JyQtS3BSYUA/cFRSIzVtSCpTX0gmNnJaIylmWixrX1IrbVdfVVs5M2wqbjhwbm8pY1VGPWxjLVMjTVp1OSldOElGO3JrLSFtNUxvI2QwOCFYMTljLDA3V2s3TltFaSlFMHFzYVdjJCFCcyt1LS5aS1hgVmQlX2lvZVo4SEQ9ZSVNQ0c6RUM2O2lYcic5cGFGKCk3W09PZ2hLJV0nIzBPW1pTMlsjLzBTQyghZ2BVXTdiYkxRYChDZEVgQDhtKjxhbUotc3FyN0tNU2kuKi0+b2M1YWRQSk9oKmQ1YVBCaGRtdVBkRytNKXJ1RnEpMzQoZEdzTT1DUkZQTSNqQCZrK0tDVi0mZiFwMCIuMT5HYi9AMz8oJ1VdIlA5Qk4/YWFOJzIoVTI0bHJeJjBmIU8mRUxVTGI/SFVdMylsJ01nJCErMEFjVztKPChNbWhkJCo8QSY5ZGtmPGZ1bGQwaGJnMF5RIjZAU1xLMFcrVFZFbCliYXVRcXRFM1E2OnQmQT07SUA8U29bcmlRYzVFb2VAQjtoJz50TFFUXk04OTtBUTMtUFldP15TXlorV2FCVCtIT0RZJTNhXFlSTzduNUBdWnE7XkhpYEM8cHItbic9Z1k7RnJJRVQ7TCc0I1Y8cDpNYT1NUENzaG9TQF9mV1ZocF40WFxQXHEmNVtkWmhCPiZsa1UqbEAnKF1DXHE4QVhELldwPXIoLlIoWmUwRF9KZnAzLy1KPzYrJ0pQXS5tMUhXOnMoaW5mUE1CQUNLYG9wTjViTVVZMDZEMC9SMUpRInIrL2FZYCoydEliLl83LmJ0dGVoLW8kZFEqTDFSbCNicXRvSjoyYWUrcypRLz5lL1xaY2haZUlhbzotbmJsdW81Uzw+XDAmOXNeZ2B1JCtTNUVHPTRaTVJ0LDFhOFE4LmdkIWl1bSNESEpiLi1JLy42WjZTZ0tnXyY0OigjY1YsXm0vU1JnbzRGMWY/Wko2RGZmJDctRk9XamMpQlksKFBFSWYqKyZMJ0chWFEhMVUiQzpJTXBAUUlnR2JDI20pP3BaZyZKSUxYOERcTzpzMkk1Lz5WazwqYFwvW3BEPjghbls+SCUoPGlMYU5VKUFMWjwwLl5kVzFoMlktKEhGWGguPW1YKjlfOWY1KC50TDErKjVmPlJpdHFJRiYjKlVCaCtFWHNfbTBqa2JvQ0tgcnFXNVlNNisoVFdOWiRlW3VKNSFGWW4tOVo3IzVCUkA0RWQ+ZWc3JFMnLXVFcz9FMV0zVFY8ZEpQVmAjSSJuK25rZThnQnQvcls5TWVjOF5BRUdQNlpRSWZSWVMkclJ+PmVuZHN0cmVhbQplbmRvYmoKeHJlZgowIDExCjAwMDAwMDAwMDAgNjU1MzUgZiAKMDAwMDAwMDA3MyAwMDAwMCBuIAowMDAwMDAwMTM0IDAwMDAwIG4gCjAwMDAwMDAyNDEgMDAwMDAgbiAKMDAwMDAwMDM1MyAwMDAwMCBuIAowMDAwMDAwNDM2IDAwMDAwIG4gCjAwMDAwMDA1NTEgMDAwMDAgbiAKMDAwMDAwMDc1NSAwMDAwMCBuIAowMDAwMDAwODIzIDAwMDAwIG4gCjAwMDAwMDExMDYgMDAwMDAgbiAKMDAwMDAwMTE2NSAwMDAwMCBuIAp0cmFpbGVyCjw8Ci9JRCAKWzxkNTBkMmVlZDM5NWE2MzE2ODZhZTViODg2MzEzZWE2Zj48ZDUwZDJlZWQzOTVhNjMxNjg2YWU1Yjg4NjMxM2VhNmY+XQolIFJlcG9ydExhYiBnZW5lcmF0ZWQgUERGIGRvY3VtZW50IC0tIGRpZ2VzdCAoaHR0cDovL3d3dy5yZXBvcnRsYWIuY29tKQoKL0luZm8gOCAwIFIKL1Jvb3QgNyAwIFIKL1NpemUgMTEKPj4Kc3RhcnR4cmVmCjM4ODIKJSVFT0YK"}];
const globalStats = {"Q01": {"B": 100.0}, "Q02": {"B": 50.0, "A": 50.0}, "Q03": {"B": 100.0}, "Q04": {"A": 100.0}, "Q05": {"B": 50.0, "C": 50.0}, "Q06": {"A": 50.0, "B": 50.0}, "Q07": {"C": 100.0}, "Q08": {"C": 100.0}, "Q09": {"A": 100.0}, "Q10": {"B": 50.0, "A": 50.0}, "Q11": {"B": 50.0, "A": 50.0}, "Q12": {"A": 50.0, "C": 50.0}, "Q13": {"C": 100.0}, "Q14": {"A": 50.0, "C": 50.0}, "Q15": {"C": 50.0, "D": 50.0}, "Q16": {"B": 100.0}, "Q17": {"A": 100.0}, "Q18": {"B": 50.0, "A": 50.0}, "Q19": {"B": 100.0, "A": 50.0}, "Q21": {"C": 100.0}, "Q22": {"B": 50.0, "C": 50.0}, "Q23": {"D": 100.0}, "Q24": {"C": 50.0, "A": 50.0}, "Q25": {"A": 50.0, "B": 50.0}, "Q26": {"C": 100.0}, "Q27": {"C": 50.0, "D": 50.0}, "Q29": {"D": 100.0}, "Q30": {"D": 100.0}, "Q28": {"D": 50.0}, "Q31": {"average": 10.0}};
const allGamesList = ["Animal Crossing", "Just Dance", "Mario Kart", "Monopoly", "Roblox", "Uno"];
const GITHUB_FRAME_URL = "https://sebastiano-mazzarisi.github.io/Test/Frame.pdf";

let currentIndex = -1;
let currentItem = null;

const pastelColors = [
    '#ffadad', '#ffd6a5', '#fdffb6', '#caffbf', '#9bf6ff', '#a0c4ff', '#bdb2ff', '#ffc6ff'
];

function renderMenu() {
    const menu = document.getElementById('menu');
    menu.innerHTML = '';
    allData.forEach((item, idx) => {
        const div = document.createElement('div');
        div.className = 'menu-item';
        div.onclick = () => showDetail(idx);
        div.innerHTML = `
            <div class="menu-item-left">
                <span class="menu-item-id">${item.id}</span>
                <span class="menu-item-sex">${item.sex}</span>
            </div>
            <span class="opt-badge">${item.opt}</span>
        `;
        menu.appendChild(div);
    });
}

function showDetail(idx) {
    currentIndex = idx;
    currentItem = allData[idx];
    document.getElementById('title').innerText = `${currentItem.id} ‚Ä¢ ${currentItem.opt}`;
    document.getElementById('prevBtn').style.display = 'block';
    document.getElementById('homeBtn').style.display = 'block';
    document.getElementById('viewBtn').style.display = 'block';
    document.getElementById('printBtn').style.display = 'block';
    document.getElementById('nextBtn').style.display = 'block';
    document.getElementById('menu').style.display = 'none';
    const detail = document.getElementById('detail');
    detail.className = 'detail active';
    
    // Reset scroll to top when opening detail
    window.scrollTo(0, 0);
    
    let html = '<div class="qa-list">';
    currentItem.answers.forEach((ans, ansIdx) => {
        const errorClass = ans.error ? ans.error : '';
        const answerText = ans.a_html || ans.a;
        html += `
            <div class="qa-item ${errorClass}" onclick="openQuestionModal(${ansIdx})">
                <div class="qa-question">${ans.q}</div>
                <div class="qa-answer">${answerText}</div>
            </div>
        `;
    });
    html += '</div>';
    detail.innerHTML = html;
}

function openQuestionModal(ansIdx) {
    const ans = currentItem.answers[ansIdx];
    document.getElementById('qModalTitle').innerText = ans.q;
    
    const container = document.getElementById('qModalContent');
    let content = '';
    
    if (ans.options) {
        const sortedKeys = Object.keys(ans.options).sort();
        const stats = globalStats[ans.key_id] || {};
        
        sortedKeys.forEach((key, index) => {
            const text = ans.options[key];
            let isSelected = false;
            if (ans.raw) { isSelected = ans.raw.includes(key); }
            
            const selectedClass = isSelected ? 'selected' : '';
            const checkMark = isSelected ? '<span class="check-mark">‚úì</span>' : '';
            const percent = stats[key] || 0;
            const barColor = pastelColors[index % pastelColors.length];
            
            content += `
            <div class="option-wrapper">
                <div class="option-row ${selectedClass}">
                    <span><strong>${key})</strong> ${text}</span>
                    ${checkMark}
                </div>
                <div class="stat-bar-container">
                     <div class="stat-bar" style="width: ${percent}%; background-color: ${barColor};"></div>
                     <span class="stat-text">${percent}%</span>
                </div>
            </div>`;
        });
    } else {
        content += `<div class="text-answer-box">${ans.a || '(Nessuna risposta)'}</div>`;
        
        if (ans.key_id === 'Q31') {
            const stats = globalStats['Q31'];
            const avg = stats ? stats.average : 0;
            content += `<div style="margin-top: 15px; font-weight: bold; color: #667eea; text-align: center; padding: 10px; background: #e3f2fd; border-radius: 6px;">
                üìä Media voti: ${avg} / 10
            </div>`;
        }
        
        if (ans.key_id === 'Q20') {
            content += '<hr style="margin: 20px 0; border: 0; border-top: 1px solid #ddd;">';
            content += '<h4 style="margin-bottom: 10px; color: #667eea;">üé≤ Tutti i giochi citati (ordine alfabetico)</h4>';
            content += '<ul class="games-list">';
            allGamesList.forEach(game => {
                content += `<li>${game}</li>`;
            });
            content += '</ul>';
        }
    }
    
    container.innerHTML = content;
    document.getElementById('questionModal').style.display = 'flex';
}

function closeModal(id) {
    document.getElementById(id).style.display = 'none';
}

function goBack() {
    currentIndex = -1;
    currentItem = null;
    document.getElementById('title').innerText = 'Questionari AVIS';
    document.getElementById('prevBtn').style.display = 'none';
    document.getElementById('homeBtn').style.display = 'none';
    document.getElementById('viewBtn').style.display = 'none';
    document.getElementById('printBtn').style.display = 'none';
    document.getElementById('nextBtn').style.display = 'none';
    document.getElementById('menu').style.display = 'grid';
    document.getElementById('detail').className = 'detail';
}

function navigate(direction) {
    const max = allData.length - 1;
    if (max < 0) return;
    let newIdx = currentIndex + direction;
    if (newIdx < 0) newIdx = 0;
    if (newIdx > max) newIdx = max;
    showDetail(newIdx);
}

function viewPDF() {
    const item = allData[currentIndex];
    const url = GITHUB_FRAME_URL + "#page=" + item.page_num;
    window.open(url, '_blank');
}

function printPDF() {
    const item = allData[currentIndex];
    if (!item.pdf_data) { alert('PDF non disponibile.'); return; }
    const byteCharacters = atob(item.pdf_data);
    const byteNumbers = new Array(byteCharacters.length);
    for (let i = 0; i < byteCharacters.length; i++) { byteNumbers[i] = byteCharacters.charCodeAt(i); }
    const byteArray = new Uint8Array(byteNumbers);
    const blob = new Blob([byteArray], { type: 'application/pdf' });
    const url = window.URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `Report_${item.id}.pdf`;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    window.URL.revokeObjectURL(url);
}

// --- TOUCH GESTURE RELOAD LOGIC ---
let touchStartY = 0;
let touchEndY = 0;

document.addEventListener('touchstart', e => {
    touchStartY = e.changedTouches[0].screenY;
}, {passive: true});

document.addEventListener('touchend', e => {
    touchEndY = e.changedTouches[0].screenY;
    handleSwipe();
}, {passive: true});

function handleSwipe() {
    const swipeDistance = touchEndY - touchStartY;
    const threshold = 150; // px
    
    // Swipe Down (al Top)
    if (swipeDistance > threshold && window.scrollY === 0) {
        triggerReload();
    }
    
    // Swipe Up (al Fondo)
    const isAtBottom = (window.innerHeight + window.scrollY) >= document.body.offsetHeight - 10;
    if (swipeDistance < -threshold && isAtBottom) {
        triggerReload();
    }
}

function triggerReload() {
    document.getElementById('loadingOverlay').style.display = 'flex';
    // Aggiunge timestamp per bypassare la cache
    setTimeout(() => {
        const currentUrl = window.location.href.split('?')[0];
        window.location.href = currentUrl + '?t=' + new Date().getTime();
    }, 500);
}

document.addEventListener('keydown', e => {
    if (e.key === 'Escape') {
        if (document.getElementById('questionModal').style.display === 'flex') {
            closeModal('questionModal'); return;
        }
        if (document.getElementById('infoModal').style.display === 'flex') {
            closeModal('infoModal'); return;
        }
    }
    if (currentIndex >= 0 && document.getElementById('questionModal').style.display !== 'flex') {
        if (e.key === 'ArrowRight') navigate(1);
        if (e.key === 'ArrowLeft') navigate(-1);
        if (e.key === 'Escape' || e.key === 'Home') goBack();
    }
});

renderMenu();
</script>
</body>
</html>
    