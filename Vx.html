<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisi Dati VX (02/09/2024 - 11/11/2025)</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>

    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f2f5;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: #fff;
            padding: 30px;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
        }
        h1 {
            color: #007bff;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
            font-size: 1.8em;
        }
        h2 {
            color: #343a40;
            margin-top: 30px;
            padding-bottom: 5px;
            border-bottom: 1px solid #ddd;
            text-align: center;
        }
        
        /* Contenitore per lo scroll delle tabelle su schermi piccoli */
        .table-container {
            overflow-x: auto;
            margin: 20px auto; 
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            width: 95%; 
            max-width: 800px;
            border: 1px solid #333; /* Cornice nera esterna */
        }

        table {
            width: 100%;
            min-width: 600px; 
            border-collapse: collapse;
        }
        th, td {
            padding: 8px 10px;
            text-align: left;
            border: 1px solid #dee2e6;
            font-size: 0.9em;
            vertical-align: middle; 
        }
        
        /* Allineamento celle dati */
        td {
            text-align: center;
        }
        
        /* Stile per valori negativi */
        .negative-value {
            color: red;
            font-weight: bold;
        }

        /* Stile per l'intestazione della tabella (TH) */
        th {
            background-color: #e0f7fa; 
            color: #004d40; 
            font-weight: bold;
            text-align: center; 
        }
        /* Stile per il rigo dei risultati (TFOOT) */
        tfoot tr {
            background-color: #e8f5e9; 
            font-weight: bold;
        }
        tfoot td {
            text-align: center; 
        }
        
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        /* Chart Container e Responsive */
        .chart-container {
            width: 95%; 
            max-width: 800px;
            margin: 30px auto;
            padding: 15px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            height: 400px; 
            border: 1px solid #333; /* Cornice nera per i grafici */
        }
        .chart-container canvas {
            height: 100% !important;
            width: 100% !important;
        }

        .print-button {
            display: block;
            margin: 10px auto 30px auto;
            padding: 12px 25px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: background-color 0.3s;
        }
        .print-button:hover {
            background-color: #1e7e34;
        }
        
        /* MEDIA QUERY PER LA STAMPA (Ottimizzata per interlinea e margini) */
        @media print {
            .print-button {
                display: none;
            }
            .container, .chart-container {
                box-shadow: none !important;
                background-color: white !important;
                padding: 0;
            }

            /* Forziamo la stampa dei colori di sfondo e della cornice */
            .table-container, .chart-container {
                border: 1px solid #333 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            th {
                background-color: #e0f7fa !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
            tfoot tr {
                background-color: #e8f5e9 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }

            h2, .table-container, .chart-container {
                page-break-inside: avoid;
            }
            
            /* RIDUZIONE INTERLINEA TABELLE */
            th, td {
                padding: 3px 10px !important; 
            }
            
            h2 {
                page-break-before: always;
                margin-top: 10px !important; 
                padding-top: 10px;
            }
            h1 + h2 {
                 page-break-before: auto;
            }
            
            /* AUMENTO MARGINE TRA TABELLA E GRAFICO PER LA STAMPA */
            .table-container {
                margin-bottom: 40px !important;
                max-width: 100% !important;
            }
            .chart-container {
                margin-top: 40px !important; 
                margin-bottom: 20px !important;
                height: 320px !important; 
                width: 100% !important;
                max-width: none !important;
            }
            .negative-value {
                color: red !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
    </style>
</head>
<body>

    <div class="container" id="content-to-print">

        <button class="print-button" onclick="window.print()">
            üñ®Ô∏è Stampa / Genera PDF (Consigliato)
        </button>

        <h1>Analisi Dati (02/09/2024 - 11/11/2025)</h1>

        <h2>üí∞ Entrate Totali (Mensili)</h2>
        <div class="table-container"> 
            <table>
                <thead>
                    <tr>
                        <th>Mese</th>
                        <th>2024-2025</th>
                        <th>2025-2026</th>
                        <th>Previsioni</th>
                        <th>Differenza</th>
                        <th>Variazione %</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Set</td><td>30.997 ‚Ç¨</td><td>41.315 ‚Ç¨</td><td>41.315 ‚Ç¨</td><td>10.318 ‚Ç¨</td><td>33.3%</td></tr>
                    <tr><td>Ott</td><td>33.138 ‚Ç¨</td><td>41.202 ‚Ç¨</td><td>41.202 ‚Ç¨</td><td>8.064 ‚Ç¨</td><td>24.3%</td></tr>
                    <tr><td>Nov</td><td>31.575 ‚Ç¨</td><td>21.817 ‚Ç¨</td><td>40.672 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Dic</td><td>23.376 ‚Ç¨</td><td>&nbsp;</td><td>30.087 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Gen</td><td>32.400 ‚Ç¨</td><td>&nbsp;</td><td>41.702 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Feb</td><td>26.390 ‚Ç¨</td><td>&nbsp;</td><td>33.967 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mar</td><td>28.694 ‚Ç¨</td><td>&nbsp;</td><td>36.932 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Apr</td><td>25.342 ‚Ç¨</td><td>&nbsp;</td><td>32.617 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mag</td><td>23.493 ‚Ç¨</td><td>&nbsp;</td><td>30.238 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Giu</td><td>19.740 ‚Ç¨</td><td>&nbsp;</td><td>25.407 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Lug</td><td>12.570 ‚Ç¨</td><td>&nbsp;</td><td>16.179 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Ago</td><td>13.400 ‚Ç¨</td><td>&nbsp;</td><td>17.247 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td><strong>Totale</strong></td>
                        <td><strong>301.115 ‚Ç¨</strong></td>
                        <td><strong>104.334 ‚Ç¨</strong></td>
                        <td><strong>387.564 ‚Ç¨</strong></td>
                        <td><strong>86.449 ‚Ç¨</strong></td> 
                        <td><strong>28.7%</strong></td> 
                    </tr>
                </tfoot>
            </table>
        </div> 
        <div class="chart-container">
            <canvas id="entrateTotaliChart"></canvas>
        </div>

        
        <h2>üí∞ Entrate TotaliX (Mensili)</h2> <div class="table-container"> 
            <table>
                <thead>
                    <tr>
                        <th>Mese</th>
                        <th>2024-2025</th> <th>2025-2026</th> <th>Previsioni</th>
                        <th>Differenza</th>
                        <th>Variazione %</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Set</td><td>1.185 ‚Ç¨</td><td>2.661 ‚Ç¨</td><td>2.661 ‚Ç¨</td><td>1.476 ‚Ç¨</td><td>124.6%</td></tr>
                    <tr><td>Ott</td><td>1.474 ‚Ç¨</td><td>1.763 ‚Ç¨</td><td>1.763 ‚Ç¨</td><td>289 ‚Ç¨</td><td>19.6%</td></tr>
                    <tr><td>Nov</td><td>1.386 ‚Ç¨</td><td>1.195 ‚Ç¨</td><td>2.385 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Dic</td><td>764 ‚Ç¨</td><td>&nbsp;</td><td>1.286 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Gen</td><td>995 ‚Ç¨</td><td>&nbsp;</td><td>1.675 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Feb</td><td>993 ‚Ç¨</td><td>&nbsp;</td><td>1.672 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mar</td><td>1.245 ‚Ç¨</td><td>&nbsp;</td><td>2.096 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Apr</td><td>1.834 ‚Ç¨</td><td>&nbsp;</td><td>3.087 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mag</td><td>933 ‚Ç¨</td><td>&nbsp;</td><td>1.571 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Giu</td><td>1.306 ‚Ç¨</td><td>&nbsp;</td><td>2.198 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Lug</td><td>510 ‚Ç¨</td><td>&nbsp;</td><td>858 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Ago</td><td>1.016 ‚Ç¨</td><td>&nbsp;</td><td>1.710 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td><strong>Totale</strong></td>
                        <td><strong>13.641 ‚Ç¨</strong></td>
                        <td><strong>5.619 ‚Ç¨</strong></td>
                        <td><strong>22.962 ‚Ç¨</strong></td>
                        <td><strong>9.321 ‚Ç¨</strong></td>
                        <td><strong>68.3%</strong></td> 
                    </tr>
                </tfoot>
            </table>
        </div> 
        <div class="chart-container">
            <canvas id="entrateTotaliNuovoChart"></canvas>
        </div>
        
        
        <h2>üíµ Entrate Contanti (Mensili)</h2>
        <div class="table-container"> 
            <table>
                <thead>
                    <tr>
                        <th>Mese</th>
                        <th>2024-2025</th> <th>2025-2026</th> <th>Previsioni</th>
                        <th>Differenza</th>
                        <th>Variazione %</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Set</td><td>10.772 ‚Ç¨</td><td>14.498 ‚Ç¨</td><td>14.498 ‚Ç¨</td><td>3.726 ‚Ç¨</td><td>34.6%</td></tr>
                    <tr><td>Ott</td><td>11.775 ‚Ç¨</td><td>13.852 ‚Ç¨</td><td>13.852 ‚Ç¨</td><td>2.078 ‚Ç¨</td><td>17.6%</td></tr>
                    <tr><td>Nov</td><td>11.211 ‚Ç¨</td><td>7.015 ‚Ç¨</td><td>14.139 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Dic</td><td>9.096 ‚Ç¨</td><td>&nbsp;</td><td>11.449 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Gen</td><td>13.328 ‚Ç¨</td><td>&nbsp;</td><td>16.775 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Feb</td><td>10.300 ‚Ç¨</td><td>&nbsp;</td><td>12.964 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mar</td><td>12.705 ‚Ç¨</td><td>&nbsp;</td><td>15.991 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Apr</td><td>9.325 ‚Ç¨</td><td>&nbsp;</td><td>11.737 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mag</td><td>12.245 ‚Ç¨</td><td>&nbsp;</td><td>15.412 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Giu</td><td>8.779 ‚Ç¨</td><td>&nbsp;</td><td>11.050 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Lug</td><td>6.345 ‚Ç¨</td><td>&nbsp;</td><td>7.986 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Ago</td><td>3.876 ‚Ç¨</td><td>&nbsp;</td><td>4.879 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td><strong>Totale</strong></td>
                        <td><strong>119.757 ‚Ç¨</strong></td>
                        <td><strong>35.366 ‚Ç¨</strong></td>
                        <td><strong>150.732 ‚Ç¨</strong></td>
                        <td><strong>30.975 ‚Ç¨</strong></td>
                        <td><strong>25.9%</strong></td>
                    </tr>
                </tfoot>
            </table>
        </div> 
        <div class="chart-container">
            <canvas id="entrateContantiChart"></canvas>
        </div>

        
        <h2>üí≥ Entrate POS (Mensili)</h2>
        <div class="table-container"> 
            <table>
                <thead>
                    <tr>
                        <th>Mese</th>
                        <th>2024-2025</th> <th>2025-2026</th> <th>Previsioni</th>
                        <th>Differenza</th>
                        <th>Variazione %</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Set</td><td>20.225 ‚Ç¨</td><td>26.817 ‚Ç¨</td><td>26.817 ‚Ç¨</td><td>6.592 ‚Ç¨</td><td>32.6%</td></tr>
                    <tr><td>Ott</td><td>21.363 ‚Ç¨</td><td>27.349 ‚Ç¨</td><td>27.349 ‚Ç¨</td><td>5.986 ‚Ç¨</td><td>28.0%</td></tr>
                    <tr><td>Nov</td><td>20.364 ‚Ç¨</td><td>14.802 ‚Ç¨</td><td>26.536 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Dic</td><td>14.280 ‚Ç¨</td><td>&nbsp;</td><td>18.602 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Gen</td><td>19.072 ‚Ç¨</td><td>&nbsp;</td><td>24.844 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Feb</td><td>16.090 ‚Ç¨</td><td>&nbsp;</td><td>20.960 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mar</td><td>15.989 ‚Ç¨</td><td>&nbsp;</td><td>20.828 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Apr</td><td>16.017 ‚Ç¨</td><td>&nbsp;</td><td>20.864 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mag</td><td>11.248 ‚Ç¨</td><td>&nbsp;</td><td>14.652 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Giu</td><td>10.961 ‚Ç¨</td><td>&nbsp;</td><td>14.278 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Lug</td><td>6.225 ‚Ç¨</td><td>&nbsp;</td><td>8.109 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Ago</td><td>9.524 ‚Ç¨</td><td>&nbsp;</td><td>12.406 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td><strong>Totale</strong></td>
                        <td><strong>181.358 ‚Ç¨</strong></td>
                        <td><strong>68.968 ‚Ç¨</strong></td>
                        <td><strong>236.245 ‚Ç¨</strong></td>
                        <td><strong>54.887 ‚Ç¨</strong></td>
                        <td><strong>30.3%</strong></td> 
                    </tr>
                </tfoot>
            </table>
        </div> 
        <div class="chart-container">
            <canvas id="entratePosChart"></canvas>
        </div>

        
        <h2>üí∏ Uscite (Mensili)</h2>
        <div class="table-container"> 
            <table>
                <thead>
                    <tr>
                        <th>Mese</th>
                        <th>2024-2025</th> <th>2025-2026</th> <th>Previsioni</th>
                        <th>Differenza</th>
                        <th>Variazione %</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Set</td><td>760 ‚Ç¨</td><td>886 ‚Ç¨</td><td>886 ‚Ç¨</td><td>126 ‚Ç¨</td><td>16.6%</td></tr>
                    <tr><td>Ott</td><td>317 ‚Ç¨</td><td>283 ‚Ç¨</td><td>283 ‚Ç¨</td><td><span class="negative-value">-34 ‚Ç¨</span></td><td><span class="negative-value">-10.8%</span></td></tr>
                    <tr><td>Nov</td><td>81 ‚Ç¨</td><td>10 ‚Ç¨</td><td>83 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Dic</td><td>314 ‚Ç¨</td><td>&nbsp;</td><td>340 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Gen</td><td>126 ‚Ç¨</td><td>&nbsp;</td><td>136 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Feb</td><td>98 ‚Ç¨</td><td>&nbsp;</td><td>106 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mar</td><td>102 ‚Ç¨</td><td>&nbsp;</td><td>111 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Apr</td><td>56 ‚Ç¨</td><td>&nbsp;</td><td>60 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Mag</td><td>18 ‚Ç¨</td><td>&nbsp;</td><td>20 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Giu</td><td>286 ‚Ç¨</td><td>&nbsp;</td><td>309 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Lug</td><td>32 ‚Ç¨</td><td>&nbsp;</td><td>34 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                    <tr><td>Ago</td><td>62 ‚Ç¨</td><td>&nbsp;</td><td>67 ‚Ç¨</td><td>&nbsp;</td><td>&nbsp;</td></tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td><strong>Totale</strong></td>
                        <td><strong>2.252 ‚Ç¨</strong></td>
                        <td><strong>1.180 ‚Ç¨</strong></td>
                        <td><strong>2.436 ‚Ç¨</strong></td>
                        <td><strong>184 ‚Ç¨</strong></td>
                        <td><strong>8.2%</strong></td>
                    </tr>
                </tfoot>
            </table>
        </div> 
        <div class="chart-container">
            <canvas id="usciteChart"></canvas>
        </div>

        
        <h2>üóìÔ∏è Giorni di Cassa (Distribuzione Movimenti)</h2>
        <div class="table-container"> 
            <table>
                <thead>
                    <tr>
                        <th>Giorno</th>
                        <th>N. Incassi</th>
                        <th>Percentuale</th>
                    </tr>
                </thead>
                <tbody>
                    <tr><td>Luned√¨</td><td>1.499</td><td>27.7%</td></tr>
                    <tr><td>Marted√¨</td><td>1.142</td><td>21.1%</td></tr>
                    <tr><td>Mercoled√¨</td><td>648</td><td>12.0%</td></tr>
                    <tr><td>Gioved√¨</td><td>924</td><td>17.1%</td></tr>
                    <tr><td>Venerd√¨</td><td>968</td><td>17.9%</td></tr>
                    <tr><td>Sabato</td><td>232</td><td>4.3%</td></tr>
                </tbody>
                <tfoot>
                    <tr><td><strong>Numero totale incassi</strong></td><td><strong>5.413</strong></td><td>&nbsp;</td></tr>
                </tfoot>
            </table>
        </div> 

        <div class="chart-container">
            <canvas id="cassaGiorniChart"></canvas>
        </div>

        
        <h2>üë§ Operatori</h2>
        <div class="table-container"> 
            <table>
                <thead>
                    <tr>
                        <th>Operatore</th>
                        <th>N. movimenti</th>
                        <th>Totale acquisito</th>
                        <th>Totale presenze</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Marica</td>
                        <td>3.472 (64.1%)</td>
                        <td>255.538 ‚Ç¨ (63.0%)</td>
                        <td>276 giorni (79.5%)</td>
                    </tr>
                    <tr>
                        <td>Sabina</td>
                        <td>1.860 (34.4%)</td>
                        <td>148.572 ‚Ç¨ (36.6%)</td>
                        <td>278 giorni (80.1%)</td>
                    </tr>
                    <tr>
                        <td>Generico</td>
                        <td>81 (1.5%)</td>
                        <td>1.338 ‚Ç¨ (0.3%)</td>
                        <td>63 giorni (18.2%)</td>
                    </tr>
                </tbody>
                <tfoot>
                    <tr>
                        <td><strong>Totale</strong></td>
                        <td><strong>5.413</strong></td>
                        <td><strong>405.449 ‚Ç¨</strong></td>
                        <td><strong>347 giorni</strong></td>
                    </tr>
                </tfoot>
            </table>
        </div> 

        <div class="chart-container">
            <canvas id="movimentiChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="acquisitoChart"></canvas>
        </div>
        <div class="chart-container">
            <canvas id="presenzeChart"></canvas>
        </div>

    </div>

    <script>
        // Registra il plugin per le etichette dei dati
        Chart.register(ChartDataLabels);

        // --- DATI DI BASE E PREVISIONI ESTRATTE DAL FILE Vx-analisi.txt ---
        
        // Funzione per sostituire gli zeri finali con null (PER LA LINEA BLU Y1)
        function replaceTrailingZerosWithNull(data) {
            let foundNonZero = false;
            for (let i = data.length - 1; i >= 0; i--) {
                if (data[i] === 0 && data[i] !== null && !foundNonZero) { 
                    data[i] = null;
                } else if (data[i] !== 0 && data[i] !== null) {
                    foundNonZero = true;
                }
            }
            return data;
        }
        
        // --- DATI STATICI (Operatori / Giorni di Cassa) ---
        const operators = ['Marica', 'Sabina', 'Generico'];
        const movimentiData = [3472, 1860, 81];
        const acquisitoData = [255538, 148572, 1338];
        const presenzeData = [276, 278, 63];
        const movimentiPercentages = [64.1, 34.4, 1.5];
        const acquisitoPercentages = [63.0, 36.6, 0.3];
        const presenzePercentages = [79.5, 80.1, 18.2];

        const giorniLabels = ['Luned√¨', 'Marted√¨', 'Mercoled√¨', 'Gioved√¨', 'Venerd√¨', 'Sabato'];
        const incassiData = [1499, 1142, 648, 924, 968, 232];
        const percentualiCassaData = [27.7, 21.1, 12.0, 17.1, 17.9, 4.3];

        const mesiLabels = ['Set', 'Ott', 'Nov', 'Dic', 'Gen', 'Feb', 'Mar', 'Apr', 'Mag', 'Giu', 'Lug', 'Ago'];
        
        // --- DATI PER GRAFICI DI CONFRONTO (Y1 = 2024-2025, Y2 = 2025-2026 Reale, P = 2025-2026 Previsioni) ---
        
        // Y1 (Linea Blu) - Mese 1
        const totali_Y1 = [30997, 33138, 31575, 23376, 32400, 26390, 28694, 25342, 23493, 19740, 12570, 13400];
        const totaliNuovo_Y1 = [1185, 1474, 1386, 764, 995, 993, 1245, 1834, 933, 1306, 510, 1016];
        const contanti_Y1 = [10772, 11775, 11211, 9096, 13328, 10300, 12705, 9325, 12245, 8779, 6345, 3876];
        const pos_Y1 = [20225, 21363, 20364, 14280, 19072, 16090, 15989, 16017, 11248, 10961, 6225, 9524];
        const uscite_Y1 = [760, 317, 81, 314, 126, 98, 102, 56, 18, 286, 32, 62];

        // Y2 (Linea Verde Reale - Mese 2)
        let totali_Y2_raw = [41315, 41202, 21817, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        let totaliNuovo_Y2_raw = [2661, 1763, 1195, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        let contanti_Y2_raw = [14498, 13852, 7015, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        let pos_Y2_raw = [26817, 27349, 14802, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        let uscite_Y2_raw = [886, 283, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0];
        
        // P (Previsioni - Linea Verde Tratteggiata)
        const totali_P = [41315, 41202, 40672, 30087, 41702, 33967, 36932, 32617, 30238, 25407, 16179, 17247];
        const totaliNuovo_P = [2661, 1763, 2385, 1286, 1675, 1672, 2096, 3087, 1571, 2198, 858, 1710];
        const contanti_P = [14498, 13852, 14139, 11449, 16775, 12964, 15991, 11737, 15412, 11050, 7986, 4879];
        const pos_P = [26817, 27349, 26536, 18602, 24844, 20960, 20828, 20864, 14652, 14278, 8109, 12406];
        const uscite_P = [886, 283, 83, 340, 136, 106, 111, 60, 20, 309, 34, 67];

        // Indice di transizione da Dati Reali a Previsioni (Ottobre = indice 1)
        const transitionIndex = 1;


        // Funzione helper per ottenere la dimensione del font in base alla larghezza dello schermo
        const getMobileFontSize = (desktopSize) => {
            return window.innerWidth <= 768 ? desktopSize * 0.8 : desktopSize;
        };


        // --- FUNZIONE PER GRAFICI OPERATORI E CASSA (SINGOLO DATASET - BARRE) ---
        function createChart(ctxId, labels, data, percentageData, labelText, colors) {
            new Chart(document.getElementById(ctxId), {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: labelText,
                        data: data,
                        backgroundColor: colors,
                        borderColor: colors.map(c => c.replace('A5F5', '76D2').replace('FF6384', 'D32F2F').replace('FFCE56', 'FFA000').replace('66BB6A', '388E3C')),
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: labelText,
                            font: { size: getMobileFontSize(16) }
                        },
                        datalabels: {
                            labels: {
                                // Etichetta 1: Valore assoluto (ORIZZONTALE, NERO)
                                valueLabel: {
                                    anchor: 'end',
                                    align: 'top',
                                    offset: 4,
                                    rotation: 0,
                                    formatter: function(value, context) {
                                        if (ctxId === 'acquisitoChart') {
                                            return value.toLocaleString('it-IT', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0, maximumFractionDigits: 0 });
                                        }
                                        return value.toLocaleString();
                                    },
                                    color: '#333',
                                    font: {
                                        weight: 'bold',
                                        size: getMobileFontSize(12) 
                                    }
                                },
                                // Etichetta 2: Percentuale (al centro della colonna)
                                percentLabel: {
                                    anchor: 'center',
                                    align: 'center',
                                    formatter: function(value, context) {
                                        const percentage = percentageData[context.dataIndex];
                                        return percentage.toFixed(1) + '%';
                                    },
                                    color: 'white',
                                    font: {
                                        weight: 'bold',
                                        size: getMobileFontSize(14) 
                                    },
                                    display: function(context) {
                                        return percentageData[context.dataIndex] > 5;
                                    }
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                font: {
                                    size: getMobileFontSize(14) 
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: (ctxId === 'acquisitoChart') ? 'Totale Acquisito (‚Ç¨)' : 'Movimenti/Incassi/Giorni',
                                font: { size: getMobileFontSize(12) } 
                            },
                            ticks: {
                                font: { size: getMobileFontSize(10) }, 
                                callback: function(value, index, values) {
                                    return (ctxId === 'acquisitoChart') ?
                                           value.toLocaleString('it-IT', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0, maximumFractionDigits: 0 }) :
                                           value.toLocaleString();
                                }
                            },
                            afterDataLimits: function(scale) {
                                scale.max = scale.max * 1.15; 
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }

        // --- FUNZIONE PER GRAFICI DI CONFRONTO (DOPPIO DATASET - LINEA con Previsioni) ---
        function createComparisonChart(ctxId, labels, dataY1, dataY2_raw, dataP, labelText) {
            
            // 1. Linea 2025-2026 REALE (Solida fino a Ottobre)
            const actualData = dataY2_raw.map((val, index) => index <= transitionIndex ? val : null);
            
            // 2. Linea 2025-2026 PREVISIONE (Tratteggiata da Ottobre in poi)
            const forecastData = dataP.map((val, index) => index >= transitionIndex ? val : null);
            // Assicura che la linea tratteggiata parta dal punto finale dei dati reali (Ottobre)
            forecastData[transitionIndex] = dataY2_raw[transitionIndex];


            new Chart(document.getElementById(ctxId), {
                type: 'line', 
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: '2024-2025', // Linea Y1 (Blu, Solida)
                            data: replaceTrailingZerosWithNull([...dataY1]), // Applica null termination a Y1
                            borderColor: '#007bff',
                            backgroundColor: '#007bff',
                            fill: false,
                            pointRadius: 5,
                            pointHoverRadius: 8,
                            tension: 0.1,
                            datalabels: {
                                display: function(context) {
                                    return context.dataset.data[context.dataIndex] !== null;
                                }
                            }
                        },
                        {
                            label: '2025-2026', // Linea Y2 (Verde, REALE, Solida) - Mostrata nella leggenda
                            data: actualData,
                            borderColor: '#28a745',
                            backgroundColor: '#28a745',
                            fill: false,
                            pointRadius: 5,
                            pointHoverRadius: 8,
                            tension: 0.1,
                            datalabels: {
                                // Etichetta solo sui dati reali (Set, Ott)
                                display: function(context) {
                                    return context.dataIndex <= transitionIndex && context.dataset.data[context.dataIndex] !== null;
                                }
                            }
                        },
                        {
                            label: '2025-2026 (Previsione)', // Linea P (Verde, TRATTEGGIATA) - Nascosta dalla leggenda, ma disegnata
                            data: forecastData,
                            borderColor: '#28a745',
                            backgroundColor: '#28a745',
                            fill: false,
                            pointRadius: 5,
                            pointHoverRadius: 8,
                            borderDash: [10, 5], /* <---- LINEA TRATTEGGIATA ATTIVA */
                            tension: 0.1,
                            datalabels: {
                                // Etichetta solo sui dati di previsione (Nov-Ago)
                                display: function(context) {
                                    return context.dataIndex > transitionIndex && context.dataset.data[context.dataIndex] !== null;
                                }
                            }
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                filter: function(item, chart) {
                                    // Nasconde l'entry della leggenda per il set tratteggiato (indice 2)
                                    return item.datasetIndex !== 2; 
                                },
                                font: { size: getMobileFontSize(14) } 
                            }
                        },
                        title: {
                            display: true,
                            text: labelText,
                            font: { size: getMobileFontSize(16) }
                        },
                        datalabels: {
                            // Configurazione comune per tutte le etichette di confronto
                            anchor: 'end', 
                            align: 'top',
                            offset: 12, 
                            rotation: 0, 
                            formatter: function(value, context) {
                                if (value === null || value === 0) return '';
                                
                                if (value >= 10000) {
                                    return (value / 1000).toFixed(0) + 'K';
                                }
                                return value.toLocaleString('it-IT', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0, maximumFractionDigits: 0 });
                            },
                            color: '#333', 
                            font: {
                                weight: 'bold',
                                size: getMobileFontSize(10) 
                            },
                            // Le regole di display specifiche sono definite internamente nei set di dati 0, 1 e 2
                            display: function(context) {
                                // Reindirizza la logica di display al dataset specifico
                                return context.dataset.datalabels.display(context);
                            }
                        }
                    },
                    scales: {
                        x: {
                            ticks: {
                                font: {
                                    size: getMobileFontSize(12) 
                                }
                            }
                        },
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Importo (‚Ç¨)',
                                font: { size: getMobileFontSize(12) } 
                            },
                            ticks: {
                                font: { size: getMobileFontSize(10) }, 
                                callback: function(value, index, values) {
                                    if (value >= 10000) {
                                        return (value / 1000).toFixed(0) + 'K ‚Ç¨';
                                    }
                                    return value.toLocaleString('it-IT', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0, maximumFractionDigits: 0 });
                                }
                            },
                            afterDataLimits: function(scale) {
                                scale.max = scale.max * 1.25; 
                            }
                        }
                    }
                },
                plugins: [ChartDataLabels]
            });
        }


        // --- ISTANZIAMENTO GRAFICI ---

        const operatorColors = ['#42A5F5', '#FF6384', '#66BB6A'];
        const cassaColors = ['#5cb85c', '#4cae4c', '#449d44', '#398439', '#2d692d', '#204d2d'];

        // 1. Grafici di Confronto Mensile (LINEA)
        createComparisonChart('entrateTotaliChart', mesiLabels, totali_Y1, totali_Y2_raw, totali_P, 'Confronto Entrate Totali Mensili');
        createComparisonChart('entrateTotaliNuovoChart', mesiLabels, totaliNuovo_Y1, totaliNuovo_Y2_raw, totaliNuovo_P, 'Confronto Entrate TotaliX Mensili'); // MODIFICATO
        createComparisonChart('entrateContantiChart', mesiLabels, contanti_Y1, contanti_Y2_raw, contanti_P, 'Confronto Entrate Contanti Mensili');
        createComparisonChart('entratePosChart', mesiLabels, pos_Y1, pos_Y2_raw, pos_P, 'Confronto Entrate POS Mensili');
        createComparisonChart('usciteChart', mesiLabels, uscite_Y1, uscite_Y2_raw, uscite_P, 'Confronto Uscite Mensili');

        // 2. Grafico Giorni di Cassa (BARRE)
        createChart('cassaGiorniChart', giorniLabels, incassiData, percentualiCassaData, 'Distribuzione Incassi per Giorno della Settimana', cassaColors);

        // 3. Grafici Operatori (BARRE)
        createChart('movimentiChart', operators, movimentiData, movimentiPercentages, 'Numero di Movimenti per Operatore', operatorColors);
        createChart('acquisitoChart', operators, acquisitoData, acquisitoPercentages, 'Totale Acquisito (‚Ç¨) per Operatore', operatorColors);
        createChart('presenzeChart', operators, presenzeData, presenzePercentages, 'Totale Presenze (Giorni) per Operatore', operatorColors);

    </script>
</body>
</html>